/*!
 * jQuery UI @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
/*!
 * jQuery UI Widget @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(){var a={};define("use",{version:"0.2.0",load:function(b,c,d,e){var f=e.use&&e.use[b];if(!f)return d();a[b]={deps:f.deps||[],attach:f.attach},c(f.deps||[],function(){c([b],function(){return attach=f.attach,e.isBuild?d():typeof attach=="function"?d(attach.apply(window,arguments)):d(window[attach])})})},write:function(b,c,d){var e=a[c],f={attach:null,deps:""};typeof attach=="function"?f.attach="return "+e.attach.toString()+";":f.attach="return window['"+e.attach+"'];",e.deps.length&&(f.deps="'"+e.deps.toString().split(",").join("','")+"'"),d(["define('",b,"!",c,"', ","[",f.deps,"],","function() {",f.attach,"}",");\n"].join(""))}})})(),function(){function a(b,c,d){if(b===c)return b!==0||1/b==1/c;if(b==null||c==null)return b===c;b._chain&&(b=b._wrapped),c._chain&&(c=c._wrapped);if(b.isEqual&&x.isFunction(b.isEqual))return b.isEqual(c);if(c.isEqual&&x.isFunction(c.isEqual))return c.isEqual(b);var e=j.call(b);if(e!=j.call(c))return!1;switch(e){case"[object String]":return b==String(c);case"[object Number]":return b!=+b?c!=+c:b==0?1/b==1/c:b==+c;case"[object Date]":case"[object Boolean]":return+b==+c;case"[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if(typeof b!="object"||typeof c!="object")return!1;var f=d.length;while(f--)if(d[f]==b)return!0;d.push(b);var g=0,h=!0;if(e=="[object Array]"){g=b.length,h=g==c.length;if(h)while(g--)if(!(h=g in b==g in c&&a(b[g],c[g],d)))break}else{if("constructor"in b!="constructor"in c||b.constructor!=c.constructor)return!1;for(var i in b)if(x.has(b,i)){g++;if(!(h=x.has(c,i)&&a(b[i],c[i],d)))break}if(h){for(i in c)if(x.has(c,i)&&!(g--))break;h=!g}}return d.pop(),h}var b=this,c=b._,d={},e=Array.prototype,f=Object.prototype,g=Function.prototype,h=e.slice,i=e.unshift,j=f.toString,k=f.hasOwnProperty,l=e.forEach,m=e.map,n=e.reduce,o=e.reduceRight,p=e.filter,q=e.every,r=e.some,s=e.indexOf,t=e.lastIndexOf,u=Array.isArray,v=Object.keys,w=g.bind,x=function(a){return new E(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):b._=x,x.VERSION="1.3.1";var y=x.each=x.forEach=function(a,b,c){if(a==null)return;if(l&&a.forEach===l)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(c,a[e],e,a)===d)return}else for(var g in a)if(x.has(a,g)&&b.call(c,a[g],g,a)===d)return};x.map=x.collect=function(a,b,c){var d=[];return a==null?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=x.toArray(a).reverse();return d&&!e&&(b=x.bind(b,d)),e?x.reduce(f,b,c,d):x.reduce(f,b)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return a==null?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return a==null?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,c){var e=!0;return a==null?e:q&&a.every===q?a.every(b,c):(y(a,function(a,f,g){if(!(e=e&&b.call(c,a,f,g)))return d}),!!e)};var z=x.some=x.any=function(a,b,c){b||(b=x.identity);var e=!1;return a==null?e:r&&a.some===r?a.some(b,c):(y(a,function(a,f,g){if(e||(e=b.call(c,a,f,g)))return d}),!!e)};x.include=x.contains=function(a,b){var c=!1;return a==null?c:s&&a.indexOf===s?a.indexOf(b)!=-1:(c=z(a,function(a){return a===b}),c)},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(x.isFunction(b)?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-Infinity;var d={computed:-Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return Infinity;var d={computed:Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b=[],c;return y(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={},d=x.isFunction(b)?b:function(a){return a[b]};return y(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?a.toArray?a.toArray():x.isArray(a)?h.call(a):x.isArguments(a)?h.call(a):x.values(a):[]},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return b!=null&&!c?h.call(a,0,b):a[0]},x.initial=function(a,b,c){return h.call(a,0,a.length-(b==null||c?1:b))},x.last=function(a,b,c){return b!=null&&!c?h.call(a,Math.max(a.length-b,0)):a[a.length-1]},x.rest=x.tail=function(a,b,c){return h.call(a,b==null||c?1:b)},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a,b){return x.reduce(a,function(a,c){return x.isArray(c)?a.concat(b?c:x.flatten(c)):(a[a.length]=c,a)},[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c){var d=c?x.map(a,c):a,e=[];return a.length<3&&(b=!0),x.reduce(d,function(c,d,f){if(b?x.last(c)!==d||!c.length:!x.include(c,d))c.push(d),e.push(a[f]);return c},[]),e},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=x.intersect=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=x.flatten(h.call(arguments,1),!0);return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var A=function(){};x.bind=function(a,b){var c,d;if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return d=h.call(arguments,2),c=function(){if(this instanceof c){A.prototype=a.prototype;var e=new A,f=a.apply(e,d.concat(h.call(arguments)));return Object(f)===f?f:e}return a.apply(b,d.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);return b.length==0&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g,h=x.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},x.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)};c&&!d&&a.apply(e,f),clearTimeout(d),d=setTimeout(g,b)}},x.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=[a].concat(h.call(arguments,0));return b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return a>0?function(){if(--a<1)return b.apply(this,arguments)}:b()},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},x.defaults=function(a){return y(h.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a},x.isEqual=function(b,c){return a(b,c,[])},x.isEmpty=function(a){if(a==null)return!0;if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType==1},x.isArray=u||function(a){return j.call(a)=="[object Array]"},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return j.call(a)=="[object Arguments]"},x.isArguments(arguments)||(x.isArguments=function(a){return!!a&&!!x.has(a,"callee")}),x.isFunction=function(a){return j.call(a)=="[object Function]"},x.isString=function(a){return j.call(a)=="[object String]"},x.isNumber=function(a){return j.call(a)=="[object Number]"},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1||j.call(a)=="[object Boolean]"},x.isDate=function(a){return j.call(a)=="[object Date]"},x.isRegExp=function(a){return j.call(a)=="[object RegExp]"},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return b._=c,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.mixin=function(a){y(x.functions(a),function(b){G(b,x[b]=a[b])})};var B=0;x.uniqueId=function(a){var b=B++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||C,function(a,b){return"',_.escape("+D(b)+"),'"}).replace(c.interpolate||C,function(a,b){return"',"+D(b)+",'"}).replace(c.evaluate||C,function(a,b){return"');"+D(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,x):function(a){return e.call(this,a,x)}},x.chain=function(a){return x(a).chain()};var E=function(a){this._wrapped=a};x.prototype=E.prototype;var F=function(a,b){return b?x(a).chain():a},G=function(a,b){E.prototype[a]=function(){var a=h.call(arguments);return i.call(a,this._wrapped),F(b.apply(x,a),this._chain)}};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];E.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],F(c,this._chain)}}),y(["concat","join","slice"],function(a){var b=e[a];E.prototype[a]=function(){return F(b.apply(this._wrapped,arguments),this._chain)}}),E.prototype.chain=function(){return this._chain=!0,this},E.prototype.value=function(){return this._wrapped}}.call(this),define("underscore",function(){}),define("use!underscore",[],function(){return window._}),function(){var a=this,b=a.Backbone,c=Array.prototype.slice,d=Array.prototype.splice,e;typeof exports!="undefined"?e=exports:e=a.Backbone={},e.VERSION="0.9.1";var f=a._;!f&&typeof require!="undefined"&&(f=require("underscore"));var g=a.jQuery||a.Zepto||a.ender;e.setDomLibrary=function(a){g=a},e.noConflict=function(){return a.Backbone=b,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.Events={on:function(a,b,c){var d;a=a.split(/\s+/);var e=this._callbacks||(this._callbacks={});while(d=a.shift()){var f=e[d]||(e[d]={}),g=f.tail||(f.tail=f.next={});g.callback=b,g.context=c,f.tail=g.next={}}return this},off:function(a,b,c){var d,e,f;if(!a)delete this._callbacks;else if(e=this._callbacks){a=a.split(/\s+/);while(d=a.shift()){f=e[d],delete e[d];if(!b||!f)continue;while((f=f.next)&&f.next)if(f.callback!==b||!!c&&f.context!==c)this.on(d,f.callback,f.context);else continue}}return this},trigger:function(a){var b,d,e,f,g,h,i;if(!(e=this._callbacks))return this;h=e.all,(a=a.split(/\s+/)).push(null);while(b=a.shift()){h&&a.push({next:h.next,tail:h.tail,event:b});if(!(d=e[b]))continue;a.push({next:d.next,tail:d.tail})}i=c.call(arguments,1);while(d=a.pop()){f=d.tail,g=d.event?[d.event].concat(i):i;while((d=d.next)!==f)d.callback.apply(d.context||this,g)}return this}},e.Events.bind=e.Events.on,e.Events.unbind=e.Events.off,e.Model=function(a,b){var c;a||(a={}),b&&b.parse&&(a=this.parse(a));if(c=u(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection),this.attributes={},this._escapedAttributes={},this.cid=f.uniqueId("c");if(!this.set(a,{silent:!0}))throw new Error("Can't create an invalid model");delete this._changed,this._previousAttributes=f.clone(this.attributes),this.initialize.apply(this,arguments)},f.extend(e.Model.prototype,e.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=f.escape(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(a,b,c){var d,g,h;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c||(c={});if(!d)return this;d instanceof e.Model&&(d=d.attributes);if(c.unset)for(g in d)d[g]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var i=this.attributes,j=this._escapedAttributes,k=this._previousAttributes||{},l=this._setting;this._changed||(this._changed={}),this._setting=!0;for(g in d){h=d[g],f.isEqual(i[g],h)||delete j[g],c.unset?delete i[g]:i[g]=h,this._changing&&!f.isEqual(this._changed[g],h)&&(this.trigger("change:"+g,this,h,c),this._moreChanges=!0),delete this._changed[g];if(!f.isEqual(k[g],h)||f.has(i,g)!=f.has(k,g))this._changed[g]=h}return l||(!c.silent&&this.hasChanged()&&this.change(c),this._setting=!1),this},unset:function(a,b){return(b||(b={})).unset=!0,this.set(a,null,b)},clear:function(a){return(a||(a={})).unset=!0,this.set(f.clone(this.attributes),a)},fetch:function(a){a=a?f.clone(a):{};var b=this,c=a.success;return a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},save:function(a,b,c){var d,g;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c=c?f.clone(c):{},c.wait&&(g=f.clone(this.attributes));var h=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?h:c))return!1;var i=this,j=c.success;c.success=function(a,b,e){var g=i.parse(a,e);c.wait&&(g=f.extend(d||{},g));if(!i.set(g,c))return!1;j?j(i,a):i.trigger("sync",i,a,c)},c.error=e.wrapError(c.error,i,c);var k=this.isNew()?"create":"update",l=(this.sync||e.sync).call(this,k,this,c);return c.wait&&this.set(g,h),l},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d();a.success=function(e){a.wait&&d(),c?c(b,e):b.trigger("sync",b,e,a)},a.error=e.wrapError(a.error,b,a);var g=(this.sync||e.sync).call(this,"delete",this,a);return a.wait||d(),g},url:function(){var a=u(this.collection,"url")||u(this,"urlRoot")||v();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(a){if(this._changing||!this.hasChanged())return this;this._changing=!0,this._moreChanges=!0;for(var b in this._changed)this.trigger("change:"+b,this,this._changed[b],a);while(this._moreChanges)this._moreChanges=!1,this.trigger("change",this,a);return this._previousAttributes=f.clone(this.attributes),delete this._changed,this._changing=!1,this},hasChanged:function(a){return arguments.length?this._changed&&f.has(this._changed,a):!f.isEmpty(this._changed)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this._changed):!1;var b,c=!1,d=this._previousAttributes;for(var e in a){if(f.isEqual(d[e],b=a[e]))continue;(c||(c={}))[e]=b}return c},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validate(a,b);return c?(b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}}),e.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,{silent:!0,parse:b.parse})},f.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){var c,e,g,h,i,j,k={},l={};b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,g=a.length;c<g;c++){if(!(h=a[c]=this._prepareModel(a[c],b)))throw new Error("Can't add an invalid model to a collection");if(k[i=h.cid]||this._byCid[i]||(j=h.id)!=null&&(l[j]||this._byId[j]))throw new Error("Can't add the same model to a collection twice");k[i]=l[j]=h}for(c=0;c<g;c++)(h=a[c]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id!=null&&(this._byId[h.id]=h);this.length+=g,e=b.at!=null?b.at:this.models.length,d.apply(this.models,[e,0].concat(a)),this.comparator&&this.sort({silent:!0});if(b.silent)return this;for(c=0,g=this.models.length;c<g;c++){if(!k[(h=this.models[c]).cid])continue;b.index=c,h.trigger("add",h,this,b)}return this},remove:function(a,b){var c,d,e,g;b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++){g=this.getByCid(a[c])||this.get(a[c]);if(!g)continue;delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g)}return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]),b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);return this._reset(),this.add(a,{silent:!0,parse:b.parse}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a=a?f.clone(a):{},a.parse===undefined&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a),c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;return b.success=function(e,f,g){b.wait&&c.add(e,b),d?d(e,f):e.trigger("sync",a,f,b)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return f(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof e.Model)a.collection||(a.collection=this);else{var c=a;b.collection=this,a=new this.model(c,b),a._validate(a.attributes,b)||(a=!1)}return a},_removeReference:function(a){this==a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var h=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];f.each(h,function(a){e.Collection.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}}),e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var i=/:\w+/g,j=/\*\w+/g,k=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(a,b,c){return e.history||(e.history=new e.History),f.isRegExp(a)||(a=this._routeToRegExp(a)),c||(c=this[b]),e.history.route(a,f.bind(function(d){var f=this._extractParameters(a,d);c&&c.apply(this,f),this.trigger.apply(this,["route:"+b].concat(f)),e.history.trigger("route",this,b,f)},this)),this},navigate:function(a,b){e.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(k,"\\$&").replace(i,"([^/]+)").replace(j,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),e.History=function(){this.handlers=[],f.bindAll(this,"checkUrl")};var l=/^[#\/]/,m=/msie [\w.]+/,n=!1;f.extend(e.History.prototype,e.Events,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c)}else a=window.location.hash;return a=decodeURIComponent(a),a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a.replace(l,"")},start:function(a){if(n)throw new Error("Backbone.history has already been started");this.options=f.extend({},{root:"/"},this.options,a),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var b=this.getFragment(),c=document.documentMode,d=m.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7);d&&(this.iframe=g('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?g(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!d?g(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=b,n=!0;var e=window.location,h=e.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&e.hash&&(this.fragment=e.hash.replace(l,""),window.history.replaceState({},document.title,e.protocol+"//"+e.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){g(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),n=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=f.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return c},navigate:function(a,b){if(!n)return!1;if(!b||b===!0)b={trigger:b};var c=(a||"").replace(l,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;this._hasPushState?(c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}}),e.View=function(a){this.cid=f.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()};var o=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName"];f.extend(e.View.prototype,e.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,b,c){var d=document.createElement(a);return b&&g(d).attr(b),c&&g(d).html(c),d},setElement:function(a,b){return this.$el=g(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=u(this,"events")))return;this.undelegateEvents();for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw new Error('Event "'+a[b]+'" does not exist');var d=b.match(o),e=d[1],g=d[2];c=f.bind(c,this),e+=".delegateEvents"+this.cid,g===""?this.$el.bind(e,c):this.$el.delegate(g,e,c)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=p.length;b<c;b++){var d=p[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(!this.el){var a=u(this,"attributes")||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.setElement(this.make(this.tagName,a),!1)}else this.setElement(this.el,!1)}});var q=function(a,b){var c=t(this,a,b);return c.extend=this.extend,c};e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=q;var r={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(a,b,c){var d=r[a],h={type:d,dataType:"json"};return c.url||(h.url=u(b,"url")||v()),!c.data&&b&&(a=="create"||a=="update")&&(h.contentType="application/json",h.data=JSON.stringify(b.toJSON())),e.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),e.emulateHTTP&&(d==="PUT"||d==="DELETE")&&(e.emulateJSON&&(h.data._method=d),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)}),h.type!=="GET"&&!e.emulateJSON&&(h.processData=!1),g.ajax(f.extend(h,c))},e.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d,a?a(b,e,c):b.trigger("error",b,e,c)}};var s=function(){},t=function(a,b,c){var d;return b&&b.hasOwnProperty("constructor")?d=b.constructor:d=function(){a.apply(this,arguments)},f.extend(d,a),s.prototype=a.prototype,d.prototype=new s,b&&f.extend(d.prototype,b),c&&f.extend(d,c),d.prototype.constructor=d,d.__super__=a.prototype,d},u=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},v=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("backbone",function(){}),define("use!backbone",["use!underscore","jquery"],function(){return window.Backbone}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/backbone-ext/Model",["use!backbone","use!underscore"],function(b,c){return c.extend(b.Model.prototype,{initialize:function(){if(this.computedAttributes!=null)return this._configureComputedAttributes()},_configureComputedAttributes:function(){var b;return b=a(function(a){return this.set(a,this[a]())},this),c.each(this.computedAttributes,a(function(a){var d;return typeof a=="string"?b(a):(b(a.name),d=c.map(a.deps,function(a){return"change:"+a}).join(" "),this.bind(d,function(){return b(a.name)}))},this))}}),b.Model})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/backbone-ext/View",["use!backbone","use!underscore"],function(b,c){return c.extend(b.View.prototype,{render:function(a){a==null&&(a={});if(a.noFilter!==!0)return this._filter()},_filter:function(){return this.$("[data-bind]").each(a(function(){return this._createBinding.apply(this,arguments)},this)),this.$("[data-behavior]").each(a(function(){return this._createBehavior.apply(this,arguments)},this))},_createBinding:function(b,c){var d,e;return d=$(c),e=d.data("bind"),this.model.bind("change:"+e,a(function(a,b){return d.html(b)},this))},_createBehavior:function(a,b){}}),b.View})}.call(this),function(){define("compiled/backbone-ext/Backbone",["use!backbone","compiled/backbone-ext/Model","compiled/backbone-ext/View"],function(a){return a})}.call(this),define("translations/discussions",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){define("compiled/util/backbone.multipart.sync",["compiled/backbone-ext/Backbone","use!underscore"],function(a,b){return a.syncWithoutMultipart=a.sync,a.syncWithMultipart=function(a,c,d){var e,f,g,h,i,j,k,l;return j="file_upload_iframe_"+(new Date).getTime(),f=$("<iframe id='"+j+"' name='"+j+"' ></iframe>").hide(),i={create:"POST",update:"PUT","delete":"DELETE",read:"GET"}[a],k=function(a,c){var d;return d=b.map(a,function(a,c){var d;if(b.isElement(a))return d=$(a),d.after(d.clone(!0)),a;if(!b.isEmpty(a)&&(b.isArray(a)||typeof a=="object"))return k(a,c);if(!(""+c).match(/^_/)&&a!=null&&typeof a!="object"&&typeof a!="function")return $("<input type='hidden' name='"+c+"' value='"+a+"' />")[0]}),b.flatten(d)},e=$("<form enctype='multipart/form-data' target='"+j+"' action='"+((l=d.url)!=null?l:c.url())+"' method='POST'>\n  <input type='hidden' name='_method' value='"+i+"' />\n  <input type='hidden' name='authenticity_token' value='"+ENV.AUTHENTICITY_TOKEN+"' />\n</form>").hide(),e.prepend(function(){var a,b,d,e;d=k(c),e=[];for(a=0,b=d.length;a<b;a++)h=d[a],h&&e.push(h);return e}()),$(document.body).prepend(f,e),g=function(){var a,b,c;return a=(f[0].contentDocument||f[0].contentWindow.document).body,b=$.parseJSON($(a).text()),b=(c=b.objects)!=null?c:b,a.className==="error"?typeof d.error=="function"&&d.error(b):typeof d.success=="function"&&d.success(b),f.remove(),e.remove()},f[0].onreadystatechange=function(){if(this.readyState==="complete")return g()},f[0].onload=g,e[0].submit()},a.sync=function(b,c,d){return(d!=null?d.multipart:void 0)?a.syncWithMultipart(b,c,d):a.syncWithoutMultipart(b,c,d)}})}.call(this),define("translations/discussions.entry_collection_view",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/discussions.participant",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("compiled/discussions/Participant",["use!backbone","i18n!discussions.participant"],function(a,c){var d;return d=function(){function d(){d.__super__.constructor.apply(this,arguments)}return b(d,a.Model),d.prototype.defaults={avatar_image_url:"",display_name:c.t("anonymous_user","Anonymous"),id:null},d}()})}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("compiled/discussions/ParticipantCollection",["use!backbone","compiled/discussions/Participant"],function(a,c){var d;return d=function(){function d(){d.__super__.constructor.apply(this,arguments)}return b(d,a.Collection),d.prototype.model=c,d}()})}.call(this),define("translations/discussions.entry",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/discussions.entry_content",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/discussions.deleted_entry",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("vendor/jquery.ui.core-1.9",["jquery","jqueryui/core"],function(a,b){function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;return!b.href||!g||f.nodeName.toLowerCase()!=="map"?!1:(h=a("img[usemap=#"+g+"]")[0],!!h&&d(h))}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(a.ui.version)return;a.extend(a.ui,{version:"@VERSION",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),e&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var f=d==="Width"?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return typeof b!="number"?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!d||!a.element[0].parentNode)return;for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:a.contains,hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}})}),define("vendor/jquery.ui.widget-1.9",["jquery","jqueryui/widget"],function(a,b){var c=Array.prototype.slice,d=a.cleanData;a.cleanData=function(b){for(var c=0,e;(e=b[c])!=null;c++)a(e).triggerHandler("remove");d(b)},a.widget=function(b,d,e){var f=b.split(".")[0],g;b=b.split(".")[1],g=f+"-"+b,e||(e=d,d=a.Widget),a.expr[":"][g]=function(c){return!!a.data(c,b)},a[f]=a[f]||{},a[f][b]=a.extend(function(c,d){if(!this._createWidget)return new a[f][b](c,d);arguments.length&&this._createWidget(c,d)},a[f][b],{version:e.version});var h=new d;h.options=a.widget.extend({},h.options),a.each(e,function(b,f){a.isFunction(f)&&(e[b]=function(){var a=function(a){return d.prototype[a].apply(this,c.call(arguments,1))},b=function(a,b){return d.prototype[a].apply(this,b)};return function(){var c=this._super,d=this._superApply,e;return this._super=a,this._superApply=b,e=f.apply(this,arguments),this._super=c,this._superApply=d,e}}())}),a[f][b].prototype=a.widget.extend(h,{namespace:f,widgetName:b,widgetEventPrefix:b,widgetBaseClass:g},e),a.widget.bridge(b,a[f][b])},a.widget.extend=function(d){var e=c.call(arguments,1),f=0,g=e.length,h,i;for(;f<g;f++)for(h in e[f])i=e[f][h],e[f].hasOwnProperty(h)&&i!==b&&(d[h]=a.isPlainObject(i)?a.widget.extend({},d[h],i):i);return d},a.widget.bridge=function(d,e){a.fn[d]=function(f){var g=typeof f=="string",h=c.call(arguments,1),i=this;return f=!g&&h.length?a.widget.extend.apply(null,[f].concat(h)):f,g?this.each(function(){var c=a.data(this,d);if(!c)return console.log("WARNING, this will break with new jqueryui: cannot call methods on "+d+" prior to initialization; "+"attempted to call method '"+f+"'");if(!a.isFunction(c[f])||f.charAt(0)==="_")return a.error("no such method '"+f+"' for "+d+" widget instance");var e=c[f].apply(c,h);if(e!==c&&e!==b)return i=e&&e.jquery?i.pushStack(e.get()):e,!1}):this.each(function(){var b=a.data(this,d);b?b.option(f||{})._init():e(f,this)}),i}},a.Widget=function(b,c){if(!this._createWidget)return new a[namespace][name](b,c);arguments.length&&this._createWidget(b,c)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,c){c=a(c||this.defaultElement||this)[0],this.element=a(c),this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),c!==this&&(a.data(c,this.widgetName,this),this._bind({remove:"destroy"})),this._create(),this._trigger("create"),this._init()},_getCreateOptions:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled"),this.bindings.unbind("."+this.widgetName),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e=c,f,g,h;if(arguments.length===0)return a.widget.extend({},this.options);if(typeof c=="string"){e={},f=c.split("."),c=f.shift();if(f.length){g=e[c]=a.widget.extend({},this.options[c]);for(h=0;h<f.length-1;h++)g[f[h]]=g[f[h]]||{},g=g[f[h]];c=f.pop();if(d===b)return g[c]===b?null:g[c];g[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];e[c]=d}}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&(this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_bind:function(b,c){c?(b=a(b),this.bindings=this.bindings.add(b)):(c=b,b=this.element);var d=this;a.each(c,function(c,e){b.bind(c+"."+d.widgetName,function(){if(d.options.disabled===!0||a(this).hasClass("ui-state-disabled"))return;return(typeof e=="string"?d[e]:e).apply(d,arguments)})})},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._bind(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._bind(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e=this.options[b],f;c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),d=d||{};if(c.originalEvent)for(var g=a.event.props.length,h;g;)h=a.event.props[--g],c[h]=c.originalEvent[h];return this.element.trigger(c,d),f=a.isArray(d)?[c].concat(d):[c,d],!(a.isFunction(e)&&e.apply(this.element[0],f)===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){typeof e=="string"&&(e={effect:e});var g,h=e?e===!0||typeof e=="number"?c:e.effect||c:b;e=e||{},typeof e=="number"&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&(a.effects.effect[h]||a.uiBackCompat!==!1&&a.effects[h])?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.uiBackCompat!==!1&&(a.Widget.prototype._getCreateOptions=function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]})}),define("vendor/jquery.ui.position-1.9",["jquery"],function(a,b){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,e=/[+-]\d+%?/,f=/^\w+/,g=/%$/,h="center",i=a.fn.position;a.position={scrollbarWidth:function(){var b,c,d=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),e=d.children()[0];return a("body").append(d),b=e.offsetWidth,d.css("overflow","scroll"),c=e.offsetWidth,b===c&&(c=d[0].clientWidth),d.remove(),b-c},getScrollInfo:function(b){var c=b[0],d=b.height()<c.scrollHeight,e=b.width()<c.scrollWidth,f=a.position.scrollbarWidth();return{height:d?f:0,width:e?f:0}}},a.fn.position=function(b){if(!b||!b.of)return i.apply(this,arguments);b=a.extend({},b);var j=a(b.of),k=a(b.within||window),l=j[0],m=(b.collision||"flip").split(" "),n={},o,p,q,r;return l.nodeType===9?(p=j.width(),q=j.height(),r={top:0,left:0}):a.isWindow(l)?(p=j.width(),q=j.height(),r={top:j.scrollTop(),left:j.scrollLeft()}):l.preventDefault?(b.at="left top",p=q=0,r={top:b.of.pageY,left:b.of.pageX}):(p=j.outerWidth(),q=j.outerHeight(),r=j.offset()),a.each(["my","at"],function(){var a=(b[this]||"").split(" "),g,i;a.length===1&&(a=c.test(a[0])?a.concat([h]):d.test(a[0])?[h].concat(a):[h,h]),a[0]=c.test(a[0])?a[0]:h,a[1]=d.test(a[1])?a[1]:h,g=e.exec(a[0]),i=e.exec(a[1]),n[this]=[g?g[0]:0,i?i[0]:0],b[this]=[f.exec(a[0])[0],f.exec(a[1])[0]]}),m.length===1&&(m[1]=m[0]),b.at[0]==="right"?r.left+=p:b.at[0]===h&&(r.left+=p/2),b.at[1]==="bottom"?r.top+=q:b.at[1]===h&&(r.top+=q/2),o=[parseInt(n.at[0],10)*(g.test(n.at[0])?p/100:1),parseInt(n.at[1],10)*(g.test(n.at[1])?q/100:1)],r.left+=o[0],r.top+=o[1],this.each(function(){var c=a(this),d=c.outerWidth(),e=c.outerHeight(),f=parseInt(a.curCSS(this,"marginLeft",!0))||0,i=parseInt(a.curCSS(this,"marginTop",!0))||0,j=a.position.getScrollInfo(k),l=d+f+(parseInt(a.curCSS(this,"marginRight",!0))||0)+j.width,s=e+i+(parseInt(a.curCSS(this,"marginBottom",!0))||0)+j.height,t=a.extend({},r),u=[parseInt(n.my[0],10)*(g.test(n.my[0])?c.outerWidth()/100:1),parseInt(n.my[1],10)*(g.test(n.my[1])?c.outerHeight()/100:1)],v;b.my[0]==="right"?t.left-=d:b.my[0]===h&&(t.left-=d/2),b.my[1]==="bottom"?t.top-=e:b.my[1]===h&&(t.top-=e/2),t.left+=u[0],t.top+=u[1],t.left=Math.round(t.left),t.top=Math.round(t.top),v={left:t.left-f,top:t.top-i},a.each(["left","top"],function(f,g){a.ui.position[m[f]]&&a.ui.position[m[f]][g](t,{targetWidth:p,targetHeight:q,elemWidth:d,elemHeight:e,collisionPosition:v,collisionWidth:l,collisionHeight:s,offset:[o[0]+u[0],o[1]+u[1]],my:b.my,at:b.at,within:k,elem:c})}),a.fn.bgiframe&&c.bgiframe(),c.offset(a.extend(t,{using:b.using}))})},a.ui.position={fit:{left:function(b,c){var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?e.scrollLeft():d.offset().left,h=f?e.width():d.outerWidth(),i=g-c.collisionPosition.left,j=c.collisionPosition.left+c.collisionWidth-h-g;c.collisionWidth>h||i>0?b.left+=i:j>0?b.left-=j:b.left=Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?e.scrollTop():d.offset().top,h=f?e.height():d.outerHeight(),i=g-c.collisionPosition.top,j=c.collisionPosition.top+c.collisionHeight-h-g;c.collisionHeight>h||i>0?b.top+=i:j>0?b.top-=j:b.top=Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]===h)return;c.elem.removeClass("ui-flipped-left ui-flipped-right");var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?0:d.offset().left,i=f?d.width():d.outerWidth(),j=c.collisionPosition.left-g,k=c.collisionPosition.left+c.collisionWidth-i-g,l=c.my[0]==="left",m=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,n=c.at[0]==="left"?c.targetWidth:-c.targetWidth,o=-2*c.offset[0];if(j<0||k>0)c.elem.addClass("ui-flipped-"+(j<0?"right":"left")),b.left+=m+n+o},top:function(b,c){if(c.at[1]===h)return;c.elem.removeClass("ui-flipped-top ui-flipped-bottom");var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?0:d.offset().top,i=f?d.height():d.outerHeight(),j=c.collisionPosition.top-g,k=c.collisionPosition.top+c.collisionHeight-i-g,l=c.my[1]==="top",m=l?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,n=c.at[1]==="top"?c.targetHeight:-c.targetHeight,o=-2*c.offset[1];if(j<0||k>0)c.elem.addClass("ui-flipped-"+(j<0?"bottom":"top")),b.top+=m+n+o}}},a.uiBackCompat!==!1&&function(a){var c=a.fn.position;a.fn.position=function(d){if(!d||!d.offset)return c.call(this,d);var e=d.offset.split(" "),f=d.at.split(" ");return e.length===1&&(e[1]=e[0]),/^\d/.test(e[0])&&(e[0]="+"+e[0]),/^\d/.test(e[1])&&(e[1]="+"+e[1]),f.length===1&&(/left|center|right/.test(f[0])?f[1]="center":(f[1]=f[0],f[0]="center")),c.call(this,a.extend(d,{at:f[0]+e[0]+" "+f[1]+e[1],offset:b}))}}(a)}),define("vendor/jquery.ui.popup-1.9",["jquery","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9","vendor/jquery.ui.position-1.9"],function(a,b,c,d){var e=0;a.widget("ui.popup",{version:"@VERSION",options:{position:{my:"left top",at:"left bottom"}},_create:function(){this.options.trigger||(this.options.trigger=this.element.prev()),this.element.attr("id")||(this.element.attr("id","ui-popup-"+e++),this.generatedId=!0),this.element.attr("role")||(this.element.attr("role","dialog"),this.generatedRole=!0),this.options.trigger.attr("aria-haspopup","true").attr("aria-owns",this.element.attr("id")),this.element.addClass("ui-popup"),this.close(),this._bind(this.options.trigger,{keydown:function(b){this.options.trigger.is("a:ui-button")&&b.keyCode==a.ui.keyCode.SPACE&&b.preventDefault(),b.keyCode==a.ui.keyCode.SPACE&&this.options.trigger.is("a:not(:ui-button)")&&this.options.trigger.trigger("click",b),b.keyCode==a.ui.keyCode.DOWN&&(b.preventDefault(),this.options.trigger.trigger("click",b))},click:function(a){a.preventDefault();if(this.isOpen)return;var b=this;clearTimeout(this.closeTimer),setTimeout(function(){b.open(a)},1)}}),this.element.is(":ui-menu")||this._bind({keydown:function(b){if(b.keyCode!==a.ui.keyCode.TAB)return;var c=a(":tabbable",this.element),d=c.first(),e=c.last();b.target===e[0]&&!b.shiftKey?(d.focus(1),b.preventDefault()):b.target===d[0]&&b.shiftKey&&(e.focus(1),b.preventDefault())}}),this._bind({focusout:function(a){var b=this;b.closeTimer=setTimeout(function(){b.close(a)},100)},focusin:function(a){clearTimeout(this.closeTimer)}}),this._bind({keyup:function(b){b.keyCode==a.ui.keyCode.ESCAPE&&this.element.is(":visible")&&(this.close(b),this.options.trigger.focus())}}),this._bind(document,{click:function(b){this.isOpen&&!a(b.target).closest(".ui-popup").length&&this.close(b)}})},_destroy:function(){this.element.show().removeClass("ui-popup").removeAttr("aria-hidden").removeAttr("aria-expanded").unbind("keypress.ui-popup"),this.options.trigger.removeAttr("aria-haspopup").removeAttr("aria-owns"),this.generatedId&&this.element.removeAttr("id"),this.generatedRole&&this.element.removeAttr("role")},open:function(b){var c=a.extend({},{of:this.options.trigger},this.options.position);this.element.show().attr("aria-hidden","false").attr("aria-expanded","true").position(c);if(this.element.is(":ui-menu"))this.element.menu("focus",b,this.element.children("li").first()),this.element.focus();else{var d=this.element.find(":tabbable");this.removeTabIndex=!1,d.length||(this.element.is(":tabbable")||(this.element.attr("tabindex","0"),this.removeTabIndex=!0),d=d.add(this.element[0])),d.first().focus(1)}this.options.trigger.attr("tabindex",-1),this.isOpen=!0,this._trigger("open",b)},close:function(a){this.element.hide().attr("aria-hidden","true").attr("aria-expanded","false"),this.options.trigger.attr("tabindex",0),this.removeTabIndex&&this.element.removeAttr("tabindex"),this.isOpen=!1,this._trigger("close",a)}})}),define("translations/discussions.reply_form",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/discussions.reply",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/discussions.reply_attachment",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/rubrics",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("vendor/jquery.ui.button-1.9",["jquery","jqueryui/button","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9"],function(a,b){var c,d,e,f,g="ui-button ui-widget ui-state-default ui-corner-all",h="ui-state-hover ui-state-active ",i="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",j=function(){var b=a(this).find(":ui-button");setTimeout(function(){b.button("refresh")},1)},k=function(b){var c=b.name,d=b.form,e=a([]);return c&&(d?e=a(d).find("[name='"+c+"']"):e=a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"@VERSION",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",j),typeof this.options.disabled!="boolean"&&(this.options.disabled=this.element.prop("disabled")),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var b=this,h=this.options,i=this.type==="checkbox"||this.type==="radio",l="ui-state-hover"+(i?"":" ui-state-active"),m="ui-state-focus";h.label===null&&(h.label=this.buttonElement.html()),this.element.is(":disabled")&&(h.disabled=!0),this.buttonElement.addClass(g).attr("role","button").bind("mouseenter.button",function(){if(h.disabled)return;a(this).addClass("ui-state-hover"),this===c&&a(this).addClass("ui-state-active")}).bind("mouseleave.button",function(){if(h.disabled)return;a(this).removeClass(l)}).bind("click.button",function(a){h.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus.button",function(){b.buttonElement.addClass(m)}).bind("blur.button",function(){b.buttonElement.removeClass(m)}),i&&(this.element.bind("change.button",function(){if(f)return;b.refresh()}),this.buttonElement.bind("mousedown.button",function(a){if(h.disabled)return;f=!1,d=a.pageX,e=a.pageY}).bind("mouseup.button",function(a){if(h.disabled)return;if(d!==a.pageX||e!==a.pageY)f=!0})),this.type==="checkbox"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).toggleClass("ui-state-active"),b.buttonElement.attr("aria-pressed",b.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).addClass("ui-state-active"),b.buttonElement.attr("aria-pressed","true");var c=b.element[0];k(c).not(c).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown.button",function(){if(h.disabled)return!1;a(this).addClass("ui-state-active"),c=this,a(document).one("mouseup",function(){c=null})}).bind("mouseup.button",function(){if(h.disabled)return!1;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(b){if(h.disabled)return!1;(b.keyCode==a.ui.keyCode.SPACE||b.keyCode==a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",h.disabled),this._resetButton()},_determineButtonType:function(){this.element.is(":checkbox")?this.type="checkbox":this.element.is(":radio")?this.type="radio":this.element.is("input")?this.type="input":this.type="button";if(this.type==="checkbox"||this.type==="radio"){var a=this.element.parents().last(),b="label[for="+this.element.attr("id")+"]";this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible");var c=this.element.is(":checked");c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(g+" "+h+" "+i).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){this._super("_setOption",a,b);if(a==="disabled"){b?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b),this.type==="radio"?k(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var b=this.buttonElement.removeClass(i),c=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",c))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}),a.ui.button.version="@VERSION",a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){a==="disabled"&&this.buttons.button("option",a,b),this._super("_setOption",a,b)},refresh:function(){var b=this.element.css("direction")==="ltr";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-left":"ui-corner-right").end().filter(":last").addClass(b?"ui-corner-right":"ui-corner-left").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}),define("vendor/ui.selectmenu",["jquery","jquery.instructure_jquery_patches","vendor/jquery.scrollTo","jqueryui/widget"],function(a){a.widget("ui.selectmenu",{getter:"value",version:"1.9",eventPrefix:"selectmenu",options:{transferClasses:!0,appendTo:"body",typeAhead:1e3,style:"dropdown",positionOptions:{my:"left top",at:"left bottom",offset:null},width:null,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null,escapeHtml:!1,bgImage:function(){}},_create:function(){var b=this,c=this.options,d=(this.element.attr("id")||"ui-selectmenu-"+Math.random().toString(16).slice(2,10)).replace(":","\\:");this.ids=[d,d+"-button",d+"-menu"],this._safemouseup=!0,this.isOpen=!1,this.newelement=a("<a />",{"class":this.widgetBaseClass+" ui-widget ui-state-default ui-corner-all",id:this.ids[1],role:"button",href:"#nogo",tabindex:this.element.attr("disabled")?1:0,"aria-haspopup":!0,"aria-owns":this.ids[2]}),this.newelementWrap=a("<span />").append(this.newelement).insertAfter(this.element);var e=this.element.attr("tabindex");e&&this.newelement.attr("tabindex",e),this.newelement.data("selectelement",this.element),this.selectmenuIcon=a('<span class="'+this.widgetBaseClass+'-icon ui-icon"></span>').prependTo(this.newelement),this.newelement.prepend('<span class="'+b.widgetBaseClass+'-status" />'),this.element.bind({"click.selectmenu":function(a){b.newelement.focus(),a.preventDefault()}}),this.newelement.bind("mousedown.selectmenu",function(a){return b._toggle(a,!0),c.style=="popup"&&(b._safemouseup=!1,setTimeout(function(){b._safemouseup=!0},300)),!1}).bind("click.selectmenu",function(){return!1}).bind("keydown.selectmenu",function(c){var d=!1;switch(c.keyCode){case a.ui.keyCode.ENTER:d=!0;break;case a.ui.keyCode.SPACE:b._toggle(c);break;case a.ui.keyCode.UP:c.altKey?b.open(c):b._moveSelection(-1);break;case a.ui.keyCode.DOWN:c.altKey?b.open(c):b._moveSelection(1);break;case a.ui.keyCode.LEFT:b._moveSelection(-1);break;case a.ui.keyCode.RIGHT:b._moveSelection(1);break;case a.ui.keyCode.TAB:d=!0;break;case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.HOME:b.index(0);break;case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.END:b.index(b._optionLis.length);break;default:d=!0}return d}).bind("keypress.selectmenu",function(a){return a.which>0&&b._typeAhead(a.which,"mouseup"),!0}).bind("mouseover.selectmenu",function(){c.disabled||a(this).addClass("ui-state-hover")}).bind("mouseout.selectmenu",function(){c.disabled||a(this).removeClass("ui-state-hover")}).bind("focus.selectmenu",function(){c.disabled||a(this).addClass("ui-state-focus")}).bind("blur.selectmenu",function(){c.disabled||a(this).removeClass("ui-state-focus")}),a(document).bind("mousedown.selectmenu-"+this.ids[0],function(a){b.isOpen&&b.close(a)}),this.element.bind("click.selectmenu",function(){b._refreshValue()}).bind("focus.selectmenu",function(){b.newelement&&b.newelement[0].focus()}),c.width||(c.width=this.element.outerWidth()),this.newelement.width(c.width),this.element.hide(),this.list=a("<ul />",{"class":"ui-widget ui-widget-content","aria-hidden":!0,role:"listbox","aria-labelledby":this.ids[1],id:this.ids[2]}),this.listWrap=a("<div />",{"class":b.widgetBaseClass+"-menu"}).append(this.list).appendTo(c.appendTo),this.list.bind("keydown.selectmenu",function(c){var d=!1;switch(c.keyCode){case a.ui.keyCode.UP:c.altKey?b.close(c,!0):b._moveFocus(-1);break;case a.ui.keyCode.DOWN:c.altKey?b.close(c,!0):b._moveFocus(1);break;case a.ui.keyCode.LEFT:b._moveFocus(-1);break;case a.ui.keyCode.RIGHT:b._moveFocus(1);break;case a.ui.keyCode.HOME:b._moveFocus(":first");break;case a.ui.keyCode.PAGE_UP:b._scrollPage("up");break;case a.ui.keyCode.PAGE_DOWN:b._scrollPage("down");break;case a.ui.keyCode.END:b._moveFocus(":last");break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:b.close(c,!0),a(c.target).parents("li:eq(0)").trigger("mouseup");break;case a.ui.keyCode.TAB:d=!0,b.close(c,!0),a(c.target).parents("li:eq(0)").trigger("mouseup");break;case a.ui.keyCode.ESCAPE:b.close(c,!0);break;default:d=!0}return d}).bind("keypress.selectmenu",function(a){return a.which>0&&b._typeAhead(a.which,"focus"),!0}).bind("mousedown.selectmenu mouseup.selectmenu",function(){return!1}),a(window).bind("resize.selectmenu-"+this.ids[0],a.proxy(b.close,this))},_init:function(){var b=this,c=this.options,d=[];this.element.find("option").each(function(){var e=a(this);d.push({value:e.attr("value"),text:b._formatText(e.text()),selected:e.attr("selected"),disabled:e.attr("disabled"),classes:e.attr("class"),typeahead:e.attr("typeahead"),parentOptGroup:e.parent("optgroup"),bgImage:c.bgImage.call(e)})});var e=b.options.style=="popup"?" ui-state-active":"";this.list.html("");if(d.length)for(var f=0;f<d.length;f++){var g={role:"presentation"};d[f].disabled&&(g["class"]=this.namespace+"-state-disabled");var h={html:d[f].text||"&nbsp;",href:"#nogo",tabindex:-1,role:"option","aria-selected":!1};d[f].disabled&&(h["aria-disabled"]=d[f].disabled),d[f].typeahead&&(h.typeahead=d[f].typeahead);var i=a("<a/>",h),j=a("<li/>",g).append(i).data("index",f).addClass(d[f].classes).data("optionClasses",d[f].classes||"").bind("mouseup.selectmenu",function(c){if(b._safemouseup&&!b._disabled(c.currentTarget)&&!b._disabled(a(c.currentTarget).parents("ul>li."+b.widgetBaseClass+"-group "))){var d=a(this).data("index")!=b._selectedIndex();b.index(a(this).data("index")),b.select(c),d&&b.change(c),b.close(c,!0)}return!1}).bind("click.selectmenu",function(){return!1}).bind("mouseover.selectmenu focus.selectmenu",function(c){!a(c.currentTarget).hasClass(b.namespace+"-state-disabled")&&!a(c.currentTarget).parent("ul").parent("li").hasClass(b.namespace+"-state-disabled")&&(b._selectedOptionLi().addClass(e),b._focusedOptionLi().removeClass(b.widgetBaseClass+"-item-focus ui-state-hover"),a(this).removeClass("ui-state-active").addClass(b.widgetBaseClass+"-item-focus ui-state-hover"))}).bind("mouseout.selectmenu blur.selectmenu",function(){a(this).is(b._selectedOptionLi().selector)&&a(this).addClass(e),a(this).removeClass(b.widgetBaseClass+"-item-focus ui-state-hover")});if(d[f].parentOptGroup.length){var k=b.widgetBaseClass+"-group-"+this.element.find("optgroup").index(d[f].parentOptGroup);this.list.find("li."+k).length?this.list.find("li."+k+":last ul").append(j):a(' <li role="presentation" class="'+b.widgetBaseClass+"-group "+k+(d[f].parentOptGroup.attr("disabled")?" "+this.namespace+'-state-disabled" aria-disabled="true"':'"')+'><span class="'+b.widgetBaseClass+'-group-label">'+d[f].parentOptGroup.attr("label")+"</span><ul></ul></li> ").appendTo(this.list).find("ul").append(j)}else j.appendTo(this.list);if(c.icons)for(var l in c.icons)if(j.is(c.icons[l].find)){j.data("optionClasses",d[f].classes+" "+b.widgetBaseClass+"-hasIcon").addClass(b.widgetBaseClass+"-hasIcon");var m=c.icons[l].icon||"";j.find("a:eq(0)").prepend('<span class="'+b.widgetBaseClass+"-item-icon ui-icon "+m+'"></span>'),d[f].bgImage&&j.find("span").css("background-image",d[f].bgImage)}}else a('<li role="presentation"><a href="#nogo" tabindex="-1" role="option"></a></li>').appendTo(this.list);var n=c.style=="dropdown";this.newelement.toggleClass(b.widgetBaseClass+"-dropdown",n).toggleClass(b.widgetBaseClass+"-popup",!n),this.list.toggleClass(b.widgetBaseClass+"-menu-dropdown ui-corner-bottom",n).toggleClass(b.widgetBaseClass+"-menu-popup ui-corner-all",!n).find("li:first").toggleClass("ui-corner-top",!n).end().find("li:last").addClass("ui-corner-bottom"),this.selectmenuIcon.toggleClass("ui-icon-triangle-1-s",n).toggleClass("ui-icon-triangle-2-n-s",!n);if(c.transferClasses){var o=this.element.attr("class")||"";this.newelement.add(this.list).addClass(o)}c.style=="dropdown"?this.list.width(c.menuWidth?c.menuWidth:c.width):this.list.width(c.menuWidth?c.menuWidth:c.width-c.handleWidth),this.list.css("height","auto");var p=this.listWrap.height(),q=a(window).height(),r=c.maxHeight?Math.min(c.maxHeight,q):q/3;p>r&&this.list.height(r),this._optionLis=this.list.find("li:not(."+b.widgetBaseClass+"-group)"),this.element.attr("disabled")?this.disable():this.enable(),this.index(this._selectedIndex()),this._selectedOptionLi().addClass(this.widgetBaseClass+"-item-focus"),clearTimeout(this.refreshTimeout),this.refreshTimeout=window.setTimeout(function(){b._refreshPosition()},200)},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetBaseClass+"-disabled"+" "+this.namespace+"-state-disabled").removeAttr("aria-disabled").unbind(".selectmenu"),a(window).unbind(".selectmenu-"+this.ids[0]),a(document).unbind(".selectmenu-"+this.ids[0]),this.newelementWrap.remove(),this.listWrap.remove(),this.element.unbind(".selectmenu").show(),a.Widget.prototype.destroy.apply(this,arguments)},_typeAhead:function(a,b){var c=this,d=String.fromCharCode(a).toLowerCase(),e=null,f=null;c._typeAhead_timer&&(window.clearTimeout(c._typeAhead_timer),c._typeAhead_timer=undefined),c._typeAhead_chars=(c._typeAhead_chars===undefined?"":c._typeAhead_chars).concat(d),c._typeAhead_chars.length<2||c._typeAhead_chars.substr(-2,1)===d&&c._typeAhead_cycling?(c._typeAhead_cycling=!0,e=d):(c._typeAhead_cycling=!1,e=c._typeAhead_chars);var g=(b!=="focus"?this._selectedOptionLi().data("index"):this._focusedOptionLi().data("index"))||0;for(var h=0;h<this._optionLis.length;h++){var i=this._optionLis.eq(h).text().substr(0,e.length).toLowerCase();if(i===e)if(c._typeAhead_cycling){f===null&&(f=h);if(h>g){f=h;break}}else f=h}f!==null&&this._optionLis.eq(f).find("a").trigger(b),c._typeAhead_timer=window.setTimeout(function(){c._typeAhead_timer=undefined,c._typeAhead_chars=undefined,c._typeAhead_cycling=undefined},c.options.typeAhead)},_uiHash:function(){var b=this.index();return{index:b,option:a("option",this.element).get(b),value:this.element[0].value}},open:function(a){var b=this,c=this.options;if(b.newelement.attr("aria-disabled")!="true"){b._closeOthers(a),b.newelement.addClass("ui-state-active"),b.listWrap.appendTo(c.appendTo),b.list.attr("aria-hidden",!1),b.listWrap.addClass(b.widgetBaseClass+"-open");var d=this._selectedOptionLi();c.style=="dropdown"?b.newelement.removeClass("ui-corner-all").addClass("ui-corner-top"):this.list.css("left",-5e3).scrollTop(this.list.scrollTop()+d.position().top-this.list.outerHeight()/2+d.outerHeight()/2).css("left","auto"),b._refreshPosition();var e=d.find("a");e.length&&e[0].focus(),b.isOpen=!0,b._trigger("open",a,b._uiHash())}},close:function(a,b){this.newelement.is(".ui-state-active")&&(this.newelement.removeClass("ui-state-active"),this.listWrap.removeClass(this.widgetBaseClass+"-open"),this.list.attr("aria-hidden",!0),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all"),b&&this.newelement.focus(),this.isOpen=!1,this._trigger("close",a,this._uiHash()))},change:function(a){this.element.trigger("change"),this._trigger("change",a,this._uiHash())},select:function(a){if(this._disabled(a.currentTarget))return!1;this._trigger("select",a,this._uiHash())},widget:function(){return this.listWrap.add(this.newelementWrap)},_closeOthers:function(b){a("."+this.widgetBaseClass+".ui-state-active").not(this.newelement).each(function(){a(this).data("selectelement").selectmenu("close",b)}),a("."+this.widgetBaseClass+".ui-state-hover").trigger("mouseout")},_toggle:function(a,b){this.isOpen?this.close(a,b):this.open(a)},_formatText:function(b){return this.options.format?b=this.options.format(b):this.options.escapeHtml&&(b=a("<div />").text(b).html()),b},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find("."+this.widgetBaseClass+"-item-focus")},_moveSelection:function(a,b){if(!this.options.disabled){var c=parseInt(this._selectedOptionLi().data("index")||0,10),d=c+a;d<0&&(d=0),d>this._optionLis.size()-1&&(d=this._optionLis.size()-1);if(d===b)return!1;this._optionLis.eq(d).hasClass(this.namespace+"-state-disabled")?(a>0?++a:--a,this._moveSelection(a,d)):this._optionLis.eq(d).trigger("mouseover").trigger("mouseup")}},_moveFocus:function(a,b){if(!isNaN(a))var c=parseInt(this._focusedOptionLi().data("index")||0,10),d=c+a;else var d=parseInt(this._optionLis.filter(a).data("index"),10);d<0&&(d=0),d>this._optionLis.size()-1&&(d=this._optionLis.size()-1);if(d===b)return!1;var e=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1e3);this._focusedOptionLi().find("a:eq(0)").attr("id",""),this._optionLis.eq(d).hasClass(this.namespace+"-state-disabled")?(a>0?++a:--a,this._moveFocus(a,d)):this._optionLis.eq(d).find("a:eq(0)").attr("id",e).focus(),this.list.attr("aria-activedescendant",e)},_scrollPage:function(a){var b=Math.floor(this.list.outerHeight()/this._optionLis.first().outerHeight());b=a=="up"?-b:b,this._moveFocus(b)},_setOption:function(a,b){this.options[a]=b,a=="disabled"&&(b&&this.close(),this.element.add(this.newelement).add(this.list)[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+this.namespace+"-state-disabled").attr("aria-disabled",b))},disable:function(a,b){typeof a=="undefined"?this._setOption("disabled",!0):b=="optgroup"?this._disableOptgroup(a):this._disableOption(a)},enable:function(a,b){typeof a=="undefined"?this._setOption("disabled",!1):b=="optgroup"?this._enableOptgroup(a):this._enableOption(a)},_disabled:function(b){return a(b).hasClass(this.namespace+"-state-disabled")},_disableOption:function(a){var b=this._optionLis.eq(a);b&&(b.addClass(this.namespace+"-state-disabled").find("a").attr("aria-disabled",!0),this.element.find("option").eq(a).attr("disabled","disabled"))},_enableOption:function(a){var b=this._optionLis.eq(a);b&&(b.removeClass(this.namespace+"-state-disabled").find("a").attr("aria-disabled",!1),this.element.find("option").eq(a).removeAttr("disabled"))},_disableOptgroup:function(a){var b=this.list.find("li."+this.widgetBaseClass+"-group-"+a);b&&(b.addClass(this.namespace+"-state-disabled").attr("aria-disabled",!0),this.element.find("optgroup").eq(a).attr("disabled","disabled"))},_enableOptgroup:function(a){var b=this.list.find("li."+this.widgetBaseClass+"-group-"+a);b&&(b.removeClass(this.namespace+"-state-disabled").attr("aria-disabled",!1),this.element.find("optgroup").eq(a).removeAttr("disabled"))},index:function(b){if(!arguments.length)return this._selectedIndex();if(!this._disabled(a(this._optionLis[b])))this.element[0].selectedIndex=b,this._refreshValue();else return!1},value:function(a){if(arguments.length)this.element[0].value=a,this._refreshValue();else return this.element[0].value},_refreshValue:function(){var a=this.options.style=="popup"?" ui-state-active":"",b=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1e3);this.list.find("."+this.widgetBaseClass+"-item-selected").removeClass(this.widgetBaseClass+"-item-selected"+a).find("a").attr("aria-selected","false").attr("id",""),this._selectedOptionLi().addClass(this.widgetBaseClass+"-item-selected"+a).find("a").attr("aria-selected","true").attr("id",b);var c=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"",d=this._selectedOptionLi().data("optionClasses")?this._selectedOptionLi().data("optionClasses"):"";this.newelement.removeClass(c).data("optionClasses",d).addClass(d).find("."+this.widgetBaseClass+"-status").html(this._selectedOptionLi().find("a:eq(0)").html()),this.list.attr("aria-activedescendant",b)},_refreshPosition:function(){var a=this.options;if(a.style=="popup"&&!a.positionOptions.offset)var b=this._selectedOptionLi(),c="0 "+(this.list.offset().top-b.offset().top-(this.newelement.outerHeight()+b.outerHeight())/2);this.listWrap.zIndex(this.element.zIndex()+1).position({of:a.positionOptions.of||this.newelement,my:a.positionOptions.my,at:a.positionOptions.at,offset:a.positionOptions.offset||c,collision:a.positionOptions.collision||a.style=="popup"?"fit":"flip"})}})}),define("vendor/jquery.ui.menu-1.9",["jquery","jqueryui/autocomplete","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9"],function(a){var b=0;a.widget("ui.menu",{version:"@VERSION",defaultElement:"<ul>",delay:150,options:{position:{my:"left top",at:"right top"}},_create:function(){var c=this;this.activeMenu=this.element,this.menuId=this.element.attr("id")||"ui-menu-"+b++,this.element.find(".ui-icon").length&&this.element.addClass("ui-menu-icons"),this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).bind("click.menu",function(b){var d=a(b.target).closest(".ui-menu-item:has(a)");if(c.options.disabled)return!1;if(!d.length)return;(!c.active||c.active[0]!==d[0])&&c.focus(b,d),c.select(b)}).bind("mouseover.menu",function(b){if(c.options.disabled)return;var d=a(b.target).closest(".ui-menu-item");d.length&&(d.siblings().children(".ui-state-active").removeClass("ui-state-active"),c.focus(b,d))}).bind("mouseout.menu",function(b){if(c.options.disabled)return;var d=a(b.target).closest(".ui-menu-item");d.length&&c.blur(b)}).bind("focus.menu",function(b){if(c.options.disabled)return;c.focus(b,a(b.target).children(".ui-menu-item:first"))}).bind("blur.menu",function(a){if(c.options.disabled)return;c.collapseAll(a)}),this.refresh(),this.element.attr("tabIndex",0).bind("keydown.menu",function(b){if(c.options.disabled)return;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:c.previousPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.PAGE_DOWN:c.nextPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.HOME:c._move("first","first",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.END:c._move("last","last",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.UP:c.previous(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.DOWN:c.next(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.LEFT:c.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.RIGHT:c.expand(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.ENTER:c.active.children("a[aria-haspopup='true']").length?c.expand(b)&&b.stopImmediatePropagation():(c.select(b),b.stopImmediatePropagation()),b.preventDefault();break;case a.ui.keyCode.ESCAPE:c.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;default:b.stopPropagation(),clearTimeout(c.filterTimer);var d,e=c.previousFilter||"",f=String.fromCharCode(b.keyCode),g=!1;f==e?g=!0:f=e+f;function h(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}d=c.activeMenu.children(".ui-menu-item").filter(function(){return(new RegExp("^"+h(f),"i")).test(a(this).children("a").text())}),d=g&&d.index(c.active.next())!=-1?c.active.nextAll(".ui-menu-item"):d,d.length||(f=String.fromCharCode(b.keyCode),d=c.activeMenu.children(".ui-menu-item").filter(function(){return(new RegExp("^"+h(f),"i")).test(a(this).children("a").text())})),d.length?(c.focus(b,d),d.length>1?(c.previousFilter=f,c.filterTimer=setTimeout(function(){delete c.previousFilter},1e3)):delete c.previousFilter):delete c.previousFilter}}),this._bind(document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b)}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show(),this.element.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove()},refresh:function(){var b=this,c=this.element.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false"),d=c.add(this.element).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation");d.children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(a){return b.element.attr("id")+"-"+a}),c.each(function(){var b=a(this),c=b.prev("a");c.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>'),b.attr("aria-labelledby",c.attr("id"))})},focus:function(b,c){var d,e=this;this.blur(b);if(this._hasScroll()){var f=parseFloat(a.curCSS(this.activeMenu[0],"borderTopWidth",!0))||0,g=parseFloat(a.curCSS(this.activeMenu[0],"paddingTop",!0))||0,h=c.offset().top-this.activeMenu.offset().top-f-g,i=this.activeMenu.scrollTop(),j=this.activeMenu.height(),k=c.height();h<0?this.activeMenu.scrollTop(i+h):h+k>j&&this.activeMenu.scrollTop(i+h-j+k)}this.active=c.first().children("a").addClass("ui-state-focus").end(),e.element.attr("aria-activedescendant",e.active.children("a").attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e.timer=setTimeout(function(){e._close()},e.delay),d=a(">ul",c),d.length&&/^mouse/.test(b.type)&&e._startOpening(d),this.activeMenu=c.parent(),this._trigger("focus",b,{item:c})},blur:function(a){if(!this.active)return;clearTimeout(this.timer),this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active})},_startOpening:function(a){clearTimeout(this.timer);if(a.attr("aria-hidden")!=="true")return;var b=this;b.timer=setTimeout(function(){b._close(),b._open(a)},b.delay)},_open:function(b){clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents()).hide().attr("aria-hidden","true");var c=a.extend({},{of:this.active},a.type(this.options.position)=="function"?this.options.position(this.active):this.options.position);b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(a){this.element.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active"),this.blur(a),this.activeMenu=this.element},_close:function(){this.active.parent().find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(b&&b.length)return this.active.parent().attr("aria-hidden","true").attr("aria-expanded","false").hide(),this.focus(a,b),!0},expand:function(a){var b=this,c=this.active&&this.active.children("ul").children("li").first();if(c&&c.length)return this._open(c.parent()),setTimeout(function(){b.focus(a,c)},20),!0},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){if(!this.active){this.focus(c,this.activeMenu.children(".ui-menu-item")[b]());return}var d;a==="first"||a==="last"?d=this.active[a==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):d=this.active[a+"All"](".ui-menu-item").eq(0),d.length?this.focus(c,d):this.focus(c,this.activeMenu.children(".ui-menu-item")[b]())},nextPage:function(b){if(this._hasScroll()){if(!this.active){this.focus(b,this.activeMenu.children(".ui-menu-item").first());return}if(this.last())return;var c=this.active.offset().top,d=this.element.height(),e;this.active.nextAll(".ui-menu-item").each(function(){return e=a(this),a(this).offset().top-c-d<0}),this.focus(b,e)}else this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(b){if(this._hasScroll()){if(!this.active){this.focus(b,this.activeMenu.children(".ui-menu-item").first());return}if(this.first())return;var c=this.active.offset().top,d=this.element.height(),e;this.active.prevAll(".ui-menu-item").each(function(){return e=a(this),a(this).offset().top-c+d>0}),this.focus(b,e)}else this.focus(b,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.height()<this.element.prop("scrollHeight")},select:function(a){var b={item:this.active};this.collapseAll(a),this._trigger("select",a,b)}})}),define("jquery.ui.menu.inputmenu",["jquery","vendor/jquery.ui.menu-1.9"],function(a,b){var c=a.ui.menu.prototype,d=c.refresh;a.extend(c,{refresh:function(){d.call(this);var b=this,c=this.element.find("li.ui-menu-item"),e=!1;this.element.bind("click.menu",function(a){(new RegExp(/^a$/i)).test(a.target.tagName)||a.preventDefault()});var f=0;this.element.find("input[type='checkbox'], input[type='radio']").each(function(){var b=a(this).closest("label");b.length&&(a(this).insertBefore(b),a(this).attr("id")||a(this).attr("id","ui-input-"+f++),b.attr("for",a(this).attr("id")))}),c.children("a").each(function(b,c){var d=a(c),f=d.parent();d.children().is("input[type='checkbox'], input[type='radio']")&&(d.closest("ul").addClass("ui-menu-icons"),d.children("input[type='checkbox']").is(":checked")?(d.prepend('<span class="ui-icon ui-icon-check"></span>'),f.attr({role:"menuitemcheckbox","aria-checked":"true"})):d.children("input[type='radio']").is(":checked")?(d.prepend('<span class="ui-icon ui-icon-radio-on"></span>'),f.attr({role:"menuitemradio","aria-checked":"true"})):d.children("input[type='radio']").length?(d.prepend('<span class="ui-icon ui-icon-radio-off"></span>'),f.attr({role:"menuitemradio","aria-checked":"false"})):f.attr({role:"menuitemcheckbox","aria-checked":"false"}),d.children().is("input[type='radio']")&&f.attr("radio-group",d.children("input[type='radio']").attr("name")),f.prev().length&&!f.prev().children("a").length?(f.prev().addClass("ui-state-disabled").html("<span class='ui-menu-input-group'>"+f.prev().text()+"</span>").bind("click.menu",!1).after('<li class="ui-menu-item"><hr /></li>'),e=!0):f.prev().length&&!f.prev().children("a").children().is("input[type='checkbox'], input[type='radio']")&&f.before("<li><hr /></li>"),e&&f.next().length&&!f.next().children("a").children().is("input[type='checkbox'], input[type='radio']")?(f.after("<li><hr /></li>"),e=!1):f.next().length&&!f.next().children("a").children().is("input[type='checkbox'], input[type='radio']")&&f.after("<li><hr /></li>"),d.children("input[type='checkbox'], input[type='radio']").hide())}),c.bind("keydown.menu",function(c){c.keyCode===a.ui.keyCode.SPACE&&(b.active.children("a").children().is("input[type='checkbox'], input[type='radio']")&&(b.select(c),c.stopImmediatePropagation()),c.preventDefault())})},select:function(b){var c={item:this.active};this.active.children("a").children().is("input[type='checkbox']")&&(this.active.attr("aria-checked")==="false"?(this.active.children("a").prepend('<span class="ui-icon ui-icon-check"></span>'),this.active.attr("aria-checked","true"),this.active.children("a").children("input[type='checkbox']").prop("checked","checked").trigger("change")):this.active.attr("aria-checked")==="true"&&(this.active.children("a").children("span.ui-icon-check").remove(),this.active.attr("aria-checked","false"),this.active.children("a").children("input[type='checkbox']").removeAttr("checked").trigger("change"))),this.active.children("a").children().is("input[type='radio']")&&this.active.attr("aria-checked")==="false"&&(this.active.children("a").children("span.ui-icon-radio-off").toggleClass("ui-icon-radio-on ui-icon-radio-off"),this.active.attr("aria-checked","true"),this.active.children("a").children("input[type='radio']").prop("checked","checked").trigger("change"),this.active.siblings("[radio-group="+a(this.active).attr("radio-group")+"]").each(function(){a(this).attr("aria-checked","false"),a(this).children("a").children("span.ui-icon-radio-on").toggleClass("ui-icon-radio-on ui-icon-radio-off"),a(this).children("a").children("input[type='radio']").removeAttr("checked")})),this.active.children("a").children().is("input[type='checkbox'], input[type='radio']")||this.collapseAll(),this._trigger("select",b,c)}})}),function(){define("compiled/jquery.kylemenu",["jquery","jquery.ui.menu.inputmenu","vendor/jquery.ui.popup-1.9","vendor/jquery.ui.button-1.9"],function(a,b,c,d){return a.fn.kyleMenu=function(b){return this.each(function(){var c,d,e,f;return f=a.extend(!0,{},a.fn.kyleMenu.defaults,b),d=a(this),f.noButton||(d.button(f.buttonOpts),d.bind("mouseleave.button",function(){if(c.is(".ui-state-open"))return d.addClass("ui-state-active")})),c=d.next().menu(f.menuOpts).popup(f.popupOpts).addClass("ui-kyle-menu use-css-transitions-for-show-hide"),e=f.appendMenuTo,e&&c.appendTo(e),d.data("kyleMenu",c),c.bind("menuselect",function(){return a(this).popup("close").removeClass("ui-state-open")})})},a.fn.kyleMenu.defaults={popupOpts:{position:{my:"center top",at:"center bottom",offset:"0 10px",within:"#main",collision:"fit"},open:function(b){var c,d,e,f,g;return a(this).find(".ui-menu-carat").remove(),c=a(this).popup("option","trigger"),c.addClass("ui-state-active"),g=c.width(),f=c.offset().left-a(this).offset().left,d=b.pageX-c.offset().left,e=Math.min(Math.max(20,d),g-20)+f,a('<span class="ui-menu-carat"><span /></span>').css("left",e).prependTo(this),a(this).css("-webkit-transform-origin-x",e+"px").addClass("ui-state-open")},close:function(){return a(this).popup("option","trigger").removeClass("ui-state-active"),a(this).removeClass("ui-state-open")}},buttonOpts:{icons:{primary:"ui-icon-home",secondary:"ui-icon-droparrow"}}},a(".al-trigger").live("click",function(b){var c,d,e;c=a(this);if(!c.is(".ui-button"))return b.preventDefault(),d={buttonOpts:{icons:{primary:null,secondary:null}}},e=a.extend(d,c.data("kyleMenuOptions")),c.kyleMenu(e),c.data("kyleMenu").popup("open")})})}.call(this),function(){define("compiled/widget/assignmentRubricDialog",["i18n!rubrics","jquery","jquery.instructure_jquery_patches","vendor/jquery.ba-tinypubsub"],function(a,b){var c;return c={initTriggers:function(){var a;if(a=b(".rubric_dialog_trigger"))return this.noRubricExists=a.data("noRubricExists"),this.url=a.data("url"),a.click(function(a){return a.preventDefault(),c.openDialog()})},initDialog:function(){return this.dialogInited=!0,this.$dialog=b("<div><h4>"+a.t("loading","Loading...")+"</h4></div>").dialog({title:a.t("titles.assignment_rubric_details","Detalles de la rúbrica del trabajo"),width:600,modal:!1,resizable:!0,autoOpen:!1}),b.get(this.url,function(a){c.$dialog.html(b(a).show());if(c.noRubricExists)return b.subscribe("edit_rubric/initted",function(){return c.$dialog.find(".button.add_rubric_link").click()})})},openDialog:function(){return this.dialogInited||this.initDialog(),this.$dialog.dialog("open")}}})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/util/BackoffPoller",["jquery","jquery.ajaxJSON"],function(b){var c;return c=function(){function c(b,c,d){var e,f,g,h,i;this.url=b,this.handler=c,d==null&&(d={}),this.handle=a(this.handle,this),this.poll=a(this.poll,this),this.baseInterval=(e=d.baseInterval)!=null?e:1e3,this.backoffFactor=(f=d.backoffFactor)!=null?f:1.5,this.maxAttempts=(g=d.maxAttempts)!=null?g:8,this.handleErrors=(h=d.handleErrors)!=null?h:!1,this.initialDelay=(i=d.initialDelay)!=null?i:!0}return c.prototype.start=function(){return this.running?this.reset():this.nextPoll(!0),this},c.prototype.then=function(a){var b;return(b=this.callbacks)==null&&(this.callbacks=[]),this.callbacks.push(a)},c.prototype.reset=function(){return this.nextInterval=this.baseInterval,this.attempts=0},c.prototype.stop=function(a){var b,c,d,e;a==null&&(a=!1),this.running&&clearTimeout(this.running),delete this.running;if(a&&this.callbacks){e=this.callbacks;for(c=0,d=e.length;c<d;c++)b=e[c],b()}return delete this.callbacks},c.prototype.poll=function(){return this.running=!0,this.attempts++,b.ajaxJSON(this.url,"GET",{},this.handle,a(function(a,b){return this.handleErrors?this.handle(a,b):this.stop()},this))},c.prototype.handle=function(a,b){switch(this.handler(a,b)){case"continue":return this.nextPoll();case"reset":return this.nextPoll(!0);case"stop":return this.stop(!0);default:return this.stop()}},c.prototype.nextPoll=function(a){a==null&&(a=!1);if(a){this.reset();if(!this.initialDelay)return this.poll()}else this.nextInterval=parseInt(this.nextInterval*this.backoffFactor);return this.attempts>this.maxAttempts?this.stop():this.running=setTimeout(this.poll,this.nextInterval)},c}()})}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b},c=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/discussions/Topic",["compiled/backbone-ext/Backbone","compiled/util/BackoffPoller"],function(a,d){var e;return e=function(){function e(){e.__super__.constructor.apply(this,arguments)}return b(e,a.Model),e.prototype.defaults={participants:[],unread_entries:[],view:null,new_entries:[]},e.prototype.url=ENV.DISCUSSION.ROOT_URL+"?include_new_entries=1",e.prototype.fetch=function(a){var b;return a==null&&(a={}),b=new d(this.url,c(function(b,c){return c.status===503?"continue":c.status!==200?"abort":(this.set(this.parse(b,200,c)),typeof a.success=="function"&&a.success(this,b),"stop")},this),{handleErrors:!0,initialDelay:!1,baseInterval:2e3,maxAttempts:11,backoffFactor:1.6}),b.start()},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.cid="discussion_topic"},e}()})}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("compiled/discussions/Entry",["jquery","use!underscore","compiled/backbone-ext/Backbone","compiled/util/backbone.multipart.sync","jquery.ajaxJSON"],function(a,c,d){var e;return e=function(){function e(){e.__super__.constructor.apply(this,arguments)}return b(e,d.Model),e.prototype.defaults={id:null,parent_id:null,message:null,user_id:null,read_state:"read",created_at:null,updated_at:null,deleted:!1,attachment:null,replies:[],parent_cid:null,collapsedView:!1,canAttach:ENV.DISCUSSION.PERMISSIONS.CAN_ATTACH,focused:!1},e.prototype.computedAttributes=["author","editor","canModerate","allowsSideComments","hideRepliesOnCollapse","speedgraderUrl",{name:"canReply",deps:["parent_id"]},{name:"summary",deps:["message"]}],e.prototype.read=function(){return""+ENV.DISCUSSION.ENTRY_ROOT_URL+"?ids[]="+this.get("id")},e.prototype.create=function(){var a;return a=this.get("parent_id"),a===null?ENV.DISCUSSION.ROOT_REPLY_URL:ENV.DISCUSSION.REPLY_URL.replace(/:entry_id/,a)},e.prototype["delete"]=function(){return ENV.DISCUSSION.DELETE_URL.replace(/:id/,this.get("id"))},e.prototype.update=function(){return ENV.DISCUSSION.DELETE_URL.replace(/:id/,this.get("id"))},e.prototype.sync=function(a,b,c){return c==null&&(c={}),c.url=this[a](),d.sync(a,this,c)},e.prototype.parse=function(a){return c.isArray(a)?a[0]:a},e.prototype.author=function(){var a;return this.get("deleted")?{}:(a=this.get("user_id"),a===ENV.DISCUSSION.CURRENT_USER.id?ENV.DISCUSSION.CURRENT_USER:DISCUSSION.participants.get(a).toJSON())},e.prototype.canModerate=function(){var a;return a=this.get("user_id")===ENV.DISCUSSION.CURRENT_USER.id,a||ENV.DISCUSSION.PERMISSIONS.MODERATE},e.prototype.canReply=function(){return ENV.DISCUSSION.PERMISSIONS.CAN_REPLY?ENV.DISCUSSION.THREADED?!0:!1:!1},e.prototype.editor=function(){var a;a=this.get("editor_id");if(!a)return;return DISCUSSION.participants.get(a).toJSON()},e.prototype.speedgraderUrl=function(){if(ENV.DISCUSSION.SPEEDGRADER_URL_TEMPLATE)return ENV.DISCUSSION.SPEEDGRADER_URL_TEMPLATE.replace(/%22%3Astudent_id%22/,this.get("user_id"))},e.prototype.summary=function(){return this.escapeDiv||(this.escapeDiv=a("<div/>")),this.escapeDiv.html(this.get("message")).text()},e.prototype.allowsSideComments=function(){var a;return a=this.get("deleted"),!ENV.DISCUSSION.THREADED&&ENV.DISCUSSION.PERMISSIONS.CAN_REPLY&&this.get("parent_id")===null&&!a},e.prototype.hideRepliesOnCollapse=function(){return!ENV.DISCUSSION.THREADED&&this.get("parent_id")===null},e.prototype.markAsRead=function(){var b;return this.set("read_state","read"),b=ENV.DISCUSSION.MARK_READ_URL.replace(/:id/,this.get("id")),a.ajaxJSON(b,"PUT")},e}()})}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("compiled/discussions/EntryCollection",["use!backbone","compiled/discussions/Entry"],function(a,c){var d;return d=function(){function d(){d.__super__.constructor.apply(this,arguments)}return b(d,a.Collection),d.prototype.model=c,d}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/discussions/MarkAsReadWatcher",["compiled/backbone-ext/Backbone","i18n!discussions","use!underscore","jquery","jquery.ajaxJSON"],function(b,c,d,e){var f,g,h;return g=2e3,f=100,h=function(){function b(c){this.view=c,this.markAsRead=a(this.markAsRead,this),b.unread.push(this),this.view.model.bind("change:collapsedView",a(function(a,b){this.ignore=b;if(b)return this.clearTimer()},this))}var c;return b.unread=[],b.prototype.createTimer=function(){return this.timer||(this.timer=setTimeout(this.markAsRead,g))},b.prototype.clearTimer=function(){return clearTimeout(this.timer),delete this.timer},b.prototype.markAsRead=function(){return this.view.model.markAsRead(),b.unread=d(b.unread).without(this),b.trigger("markAsRead",this.view.model)},c=e(window),b.init=function(){return c.bind("scroll resize",this.checkForVisibleEntries),this.checkForVisibleEntries()},b.checkForVisibleEntries=d.throttle(a(function(){var a,b,d,e,f,g,h,i;f=c.scrollTop(),a=f+c.height(),i=this.unread;for(g=0,h=i.length;g<h;g++){b=i[g];if(b.ignore)continue;e=b.view.$el.offset().top,d=e<a&&e+b.view.$el.height()>f,b[d?"createTimer":"clearTimer"]()}},b),f),b}.call(this),d.extend(h,b.Events)})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/editor/EditorToggle",["i18n!editor","jquery","tinymce.editor_box"],function(b,c){var d;return d=function(){function d(a,b){this.el=a,this.options=c.extend({},this.options,b),this.textArea=this.createTextArea(),this.done=this.createDone(),this.content=this.getContent(),this.editing=!1}return d.prototype.options={doneText:b.t("done_as_in_finished","Aceptar")},d.prototype.toggle=function(){return this.editing?this.display():this.edit()},d.prototype.edit=function(){return this.textArea.val(this.getContent()),this.textArea.insertBefore(this.el),this.el.detach(),this.done.insertAfter(this.textArea),this.textArea.editorBox(),this.editing=!0},d.prototype.display=function(){return this.content=this.textArea._justGetCode(),this.textArea.val(this.content),this.el.html(this.content),this.el.insertBefore(this.textArea),this.textArea._removeEditor(),this.textArea.detach(),this.done.detach(),this.textArea.attr("id",""),this.editing=!1},d.prototype.getContent=function(){return c.trim(this.el.html())},d.prototype.createTextArea=function(){return c("<textarea/>").css("width","100%").addClass("editor-toggle")},d.prototype.createDone=function(){return c("<a/>").html(this.options.doneText).addClass("button edit-html-done edit_html_done").click(a(function(){return this.display()},this))},d}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Object.prototype.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};define("compiled/discussions/EntryEditor",["i18n!editor","jquery","compiled/editor/EditorToggle"],function(b,d,e){var f;return f=function(){function f(b){this.view=b,this.onSaveError=a(this.onSaveError,this),this.onSaveSuccess=a(this.onSaveSuccess,this),f.__super__.constructor.call(this,this.view.$(".message:first")),this.cancelButton=this.createCancelButton(),this.done.addClass("small-button")}return c(f,e),f.prototype.display=function(a){f.__super__.display.apply(this,arguments),this.cancelButton.detach();if((a!=null?a.cancel:void 0)!==!0)return this.view.model.save({messageNotification:b.t("saving","Saving..."),message:this.content},{success:this.onSaveSuccess,error:this.onSaveError})},f.prototype.createCancelButton=function(){return d("<a/>").html(b.t("cancel","Cancelar")).attr("href","javascript:").addClass("cancel_button").click(a(function(){return this.display({cancel:!0})},this))},f.prototype.edit=function(){return f.__super__.edit.apply(this,arguments),this.cancelButton.insertAfter(this.done)},f.prototype.getContent=function(){return this.view.model.get("message")},f.prototype.onSaveSuccess=function(){return this.view.model.set("messageNotification","")},f.prototype.onSaveError=function(){return this.view.model.set({messageNotification:b.t("save_failed","Failed to save, please try again later")}),this.edit()},f}()})}.call(this),define("jst/discussions/EntryCollectionView",["compiled/handlebars_helpers","i18n!discussions.entry_collection_view"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/EntryCollectionView"]=b(function(a,b,c,d,e){function f(a,b){var d="",e,f,g,h;d+='\n  <span class="add_root_reply">&#8593; <a href="*">',e="Añadir respuesta al anuncio",f="add_reply_to_topic",g={},h="discussions.EntryCollectionView",g.scope=h,h=c.t||a.t,j={},j.hash=g,typeof h===l?e=h.call(a,f,e,j):h===n?e=m.call(a,"t",f,e,j):e=h;if(e||e===0)d+=e;return d+="</a></span>\n",d}c=c||a.helpers;var g="",h,i,j,k=this,l="function",m=c.helperMissing,n=void 0;g+='<ul class="discussion-entries"></ul>\n\n',h=c.showReplyButton||b.showReplyButton,i=c["if"],j=k.program(1,f,e),j.hash={},j.fn=j,j.inverse=k.noop,h=i.call(b,h,j);if(h||h===0)g+=h;return g+="\n\n",g}),c["discussions/EntryCollectionView"]}),define("jst/discussions/_entry_content",["compiled/handlebars_helpers","i18n!discussions.entry_content"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/_entry_content"]=b(function(a,b,c,d,e){function f(a,b){var d;return d=c.parent_cid||a.parent_cid,typeof d===w?d=d.call(a,{hash:{}}):d===y&&(d=x.call(a,"parent_cid",{hash:{}})),z(d)}function g(a,b){return"content"}function h(a,b){var d="",e,f,g,h;d+='\n          <li><a data-event="edit" href="#"><span class="ui-icon ui-icon-pencil" />',e="Editar",f="editar",g={},h="discussions.entry_content",g.scope=h,h=c.t||a.t,u={},u.hash=g,typeof h===w?e=h.call(a,f,e,u):h===y?e=x.call(a,"t",f,e,u):e=h;if(e||e===0)d+=e;d+='</a></li>\n          <li><a data-event="remove" href="#"><span class="ui-icon ui-icon-trash" />',e="Eliminar",f="eliminar",g={},h="discussions.entry_content",g.scope=h,h=c.t||a.t,u={},u.hash=g,typeof h===w?e=h.call(a,f,e,u):h===y?e=x.call(a,"t",f,e,u):e=h;if(e||e===0)d+=e;return d+="</a></li>\n        ",d}function i(a,b){var d="",e,f,g,h;d+='\n          <li><a href="',e=c.speedgraderUrl||a.speedgraderUrl,typeof e===w?e=e.call(a,{hash:{}}):e===y&&(e=x.call(a,"speedgraderUrl",{hash:{}})),d+=z(e)+'"><span class="ui-icon ui-icon-check" />',e="Abrir en Calificador rápido",f="open_in_speedgrader",g={},h="discussions.entry_content",g.scope=h,h=c.t||a.t,u={},u.hash=g,typeof h===w?e=h.call(a,f,e,u):h===y?e=x.call(a,"t",f,e,u):e=h;if(e||e===0)d+=e;return d+="</a></li>\n        ",d}function j(a,b){var d="",e;return d+=' href="',e=c.author||a.author,e=e===null||e===undefined||e===!1?e:e.url,typeof e===w?e=e.call(a,{hash:{}}):e===y&&(e=x.call(a,"author.url",{hash:{}})),d+=z(e)+'" ',d}function k(a,b){var d="",e,f;d+='\n    <div class="discussion-fyi">Este comentario fue editado por <a ',e=c.editor||a.editor,e=e===null||e===undefined||e===!1?e:e.url,f=c["if"],u=v.program(12,l,b),u.hash={},u.fn=u,u.inverse=v.noop,e=f.call(a,e,u);if(e||e===0)d+=e;return d+=">",e=c.editor||a.editor,e=e===null||e===undefined||e===!1?e:e.display_name,typeof e===w?e=e.call(a,{hash:{}}):e===y&&(e=x.call(a,"editor.display_name",{hash:{}})),d+=z(e)+"</a></div>\n  ",d}function l(a,b){var d="",e;return d+=' href="',e=c.editor||a.editor,e=e===null||e===undefined||e===!1?e:e.url,typeof e===w?e=e.call(a,{hash:{}}):e===y&&(e=x.call(a,"editor.url",{hash:{}})),d+=z(e)+'" ',d}function m(a,b){var d="",e,f;d+='\n    <div class="comment_attachments">\n      ',e=c.attachments||a.attachments,f=c.each,u=v.program(15,n,b),u.hash={},u.fn=u,u.inverse=v.noop,e=f.call(a,e,u);if(e||e===0)d+=e;return d+="\n    </div>\n  ",d}function n(a,b){var d="",e,f;return d+='\n        <div><a href="',e=c.url||a.url,typeof e===w?e=e.call(a,{hash:{}}):e===y&&(e=x.call(a,"url",{hash:{}})),d+=z(e)+'" class="',e=c["content-type"]||a["content-type"],f=c.mimeClass||a.mimeClass,typeof f===w?e=f.call(a,e,{hash:{}}):f===y?e=x.call(a,"mimeClass",e,{hash:{}}):e=f,d+=z(e)+'" title="',e=c.filename||a.filename,typeof e===w?e=e.call(a,{hash:{}}):e===y&&(e=x.call(a,"filename",{hash:{}})),d+=z(e)+'">',e=c.display_name||a.display_name,typeof e===w?e=e.call(a,{hash:{}}):e===y&&(e=x.call(a,"display_name",{hash:{}})),d+=z(e)+"</a></div>\n      ",d}function o(a,b){var e="",f;e+="\n  ",f=a,f=v.invokePartial(d["discussions/reply_form"],"discussions/reply_form",f,c,d);if(f||f===0)e+=f;return e+="\n",e}c=c||a.helpers,d=d||a.partials;var p="",q,r,s,t,u,v=this,w="function",x=c.helperMissing,y=void 0,z=this.escapeExpression;p+='<header class="discussion-section admin-link-hover-area ',q=c.read_state||b.read_state,typeof q===w?q=q.call(b,{hash:{}}):q===y&&(q=x.call(b,"read_state",{hash:{}})),p+=z(q)+' clearfix" data-event="toggleCollapsed">\n  <div class="discussion-read-state tooltip">\n    <span class="tooltip_wrap unread">\n      <span class="tooltip_text">',q="No leído",r="unread",s={},t="discussions.entry_content",s.scope=t,t=c.t||b.t,u={},u.hash=s,typeof t===w?q=t.call(b,r,q,u):t===y?q=x.call(b,"t",r,q,u):q=t;if(q||q===0)p+=q;p+='</span>\n    </span>\n    <span class="tooltip_wrap just_read">\n      <span class="tooltip_text">',q="Solo leer",r="just_read",s={},t="discussions.entry_content",s.scope=t,t=c.t||b.t,u={},u.hash=s,typeof t===w?q=t.call(b,r,q,u):t===y?q=x.call(b,"t",r,q,u):q=t;if(q||q===0)p+=q;p+="</span>\n    </span>\n  </div>\n  ",q=c.author||b.author,q=v.invokePartial(d.avatar,"avatar",q,c,d);if(q||q===0)p+=q;p+='\n  <div class="discussion-header-content right-of-avatar">\n    <div class="hide-if-collapsed admin-links">\n      <button class="al-trigger" data-event="openMenu"><span class="al-trigger-inner">',q="Manejar",r="manage",s={},t="discussions.entry_content",s.scope=t,t=c.t||b.t,u={},u.hash=s,typeof t===w?q=t.call(b,r,q,u):t===y?q=x.call(b,"t",r,q,u):q=t;if(q||q===0)p+=q;p+='</span></button>\n      <ul class="al-options">\n        <li><a href="#',q=c.parent_cid||b.parent_cid,r=c["if"],u=v.program(1,f,e),u.hash={},u.fn=u,u.inverse=v.program(3,g,e),q=r.call(b,q,u);if(q||q===0)p+=q;p+='"><span class="ui-icon ui-icon-arrowreturnthick-1-w" />',q="Ir al padre",r="go_to_parent",s={},t="discussions.entry_content",s.scope=t,t=c.t||b.t,u={},u.hash=s,typeof t===w?q=t.call(b,r,q,u):t===y?q=x.call(b,"t",r,q,u):q=t;if(q||q===0)p+=q;p+="</a></li>\n        ",q=c.canModerate||b.canModerate,r=c["if"],u=v.program(5,h,e),u.hash={},u.fn=u,u.inverse=v.noop,q=r.call(b,q,u);if(q||q===0)p+=q;p+="\n        ",q=c.speedgraderUrl||b.speedgraderUrl,r=c["if"],u=v.program(7,i,e),u.hash={},u.fn=u,u.inverse=v.noop,q=r.call(b,q,u);if(q||q===0)p+=q;p+='\n      </ul>\n    </div>\n    <div class="discussion-header-right">\n      <div class="discussion-pubdate">',q=c.updated_at||b.updated_at,r={},s=!0,r.pubdate=s,s=c.friendlyDatetime||b.friendlyDatetime,u={},u.hash=r,typeof s===w?q=s.call(b,q,u):s===y?q=x.call(b,"friendlyDatetime",q,u):q=s,p+=z(q)+'</div>\n    </div>\n    <h2 class="discussion-title">\n      <a class="author" title="',q="Nombre del autor",r="authors_name",s={},t="discussions.entry_content",s.scope=t,t=c.t||b.t,u={},u.hash=s,typeof t===w?q=t.call(b,r,q,u):t===y?q=x.call(b,"t",r,q,u):q=t;if(q||q===0)p+=q;p+='" ',q=c.author||b.author,q=q===null||q===undefined||q===!1?q:q.url,r=c["if"],u=v.program(9,j,e),u.hash={},u.fn=u,u.inverse=v.noop,q=r.call(b,q,u);if(q||q===0)p+=q;p+=' class="author">',q=c.author||b.author,q=q===null||q===undefined||q===!1?q:q.display_name,typeof q===w?q=q.call(b,{hash:{}}):q===y&&(q=x.call(b,"author.display_name",{hash:{}})),p+=z(q)+'</a>\n    </h2>\n    <h1 class="show-if-collapsed discussion-subtitle summary ellipsis">',q=c.summary||b.summary,typeof q===w?q=q.call(b,{hash:{}}):q===y&&(q=x.call(b,"summary",{hash:{}})),p+=z(q)+'</h1>\n  </div>\n</header>\n<div class="discussion-section hide-if-collapsed message_wrapper">\n  <span class="message-notification" data-bind="messageNotification"></span>\n  <div data-bind="message" class="message user_content">',q=c.message||b.message,r=c.convertNativeToMediaCommentThumnail||b.convertNativeToMediaCommentThumnail,typeof r===w?q=r.call(b,q,{hash:{}}):r===y?q=x.call(b,"convertNativeToMediaCommentThumnail",q,{hash:{}}):q=r,p+=z(q)+"</div>\n  ",q=c.editor||b.editor,r=c["if"],u=v.program(11,k,e),u.hash={},u.fn=u,u.inverse=v.noop,q=r.call(b,q,u);if(q||q===0)p+=q;p+="\n  ",q=c.attachments||b.attachments,r=c["if"],u=v.program(14,m,e),u.hash={},u.fn=u,u.inverse=v.noop,q=r.call(b,q,u);if(q||q===0)p+=q;p+="\n</div>\n",q=c.canReply||b.canReply,r=c["if"],u=v.program(17,o,e),u.hash={},u.fn=u,u.inverse=v.noop,q=r.call(b,q,u);if(q||q===0)p+=q;return p+="\n",p}),a.registerPartial("discussions/entry_content",c["discussions/_entry_content"]),c["discussions/_entry_content"]}),define("jst/discussions/_deleted_entry",["compiled/handlebars_helpers","i18n!discussions.deleted_entry"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/_deleted_entry"]=b(function(a,b,c,d,e){function f(a,b){return"admin-link-hover-area"}c=c||a.helpers;var g="",h,i,j,k,l,m=this,n="function",o=c.helperMissing,p=void 0,q=this.escapeExpression;g+='<header class="',h=c.hideRepliesOnCollapse||b.hideRepliesOnCollapse,i=c["if"],l=m.program(1,f,e),l.hash={},l.fn=l,l.inverse=m.noop,h=i.call(b,h,l);if(h||h===0)g+=h;g+=" discussion-section ",h=c.read_state||b.read_state,typeof h===n?h=h.call(b,{hash:{}}):h===p&&(h=o.call(b,"read_state",{hash:{}})),g+=q(h)+'" data-event="toggleCollapsed">\n  <div class="discussion-header-content right-of-avatar">\n    <h1 class="discussion-title">',h="Esta entrada ha sido borrada",i="deleted",j={},k="discussions.deleted_entry",j.scope=k,k=c.t||b.t,l={},l.hash=j,typeof k===n?h=k.call(b,i,h,l):k===p?h=o.call(b,"t",i,h,l):h=k;if(h||h===0)g+=h;return g+="</h1>\n  </div>\n</header>\n\n",g}),a.registerPartial("discussions/deleted_entry",c["discussions/_deleted_entry"]),c["discussions/_deleted_entry"]}),define("jst/discussions/entry_with_replies",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/entry_with_replies"]=b(function(a,b,c,d,e){function f(a,b){var e="",f;e+="\n      ",f=a,f=m.invokePartial(d["discussions/deleted_entry"],"discussions/deleted_entry",f,c,d);if(f||f===0)e+=f;return e+="\n    ",e}function g(a,b){var e="",f;e+="\n      ",f=a,f=m.invokePartial(d["discussions/entry_content"],"discussions/entry_content",f,c,d);if(f||f===0)e+=f;return e+="\n    ",e}function h(a,b){var e="",f;e+='\n  <div class="add-side-comment-wrap">\n    ',f=a,f=m.invokePartial(d["discussions/reply_form"],"discussions/reply_form",f,c,d);if(f||f===0)e+=f;return e+="\n  </div>\n",e}c=c||a.helpers,d=d||a.partials;var i="",j,k,l,m=this,n="function",o=c.helperMissing,p=void 0,q=this.escapeExpression;i+='<article class="discussion_entry can_be_marked_as_read ',j=c.read_state||b.read_state,typeof j===n?j=j.call(b,{hash:{}}):j===p&&(j=o.call(b,"read_state",{hash:{}})),i+=q(j)+'" data-mark-read-url="',j=c.mark_read_url||b.mark_read_url,typeof j===n?j=j.call(b,{hash:{}}):j===p&&(j=o.call(b,"mark_read_url",{hash:{}})),i+=q(j)+'">\n  <div class="entry_content">\n    ',j=c.deleted||b.deleted,k=c["if"],l=m.program(1,f,e),l.hash={},l.fn=l,l.inverse=m.program(3,g,e),j=k.call(b,j,l);if(j||j===0)i+=j;i+='\n  </div>\n</article>\n<div class="replies"></div>\n',j=c.allowsSideComments||b.allowsSideComments,k=c["if"],l=m.program(5,h,e),l.hash={},l.fn=l,l.inverse=m.noop,j=k.call(b,j,l);if(j||j===0)i+=j;return i+="\n\n\n",i}),c["discussions/entry_with_replies"]}),define("jst/_avatar",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c._avatar=b(function(a,b,c,d,e){function f(a,b){var d="",e,f;d+="\n  <a ",e=c.url||a.url,f=c["if"],k=l.program(2,g,b),k.hash={},k.fn=k,k.inverse=l.noop,e=f.call(a,e,k);if(e||e===0)d+=e;return d+=' class="avatar"><img src="',e=c.avatar_image_url||a.avatar_image_url,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"avatar_image_url",{hash:{}})),d+=p(e)+'" alt="',e=c.display_name||a.display_name,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"display_name",{hash:{}})),d+=p(e)+'"></a>\n',d}function g(a,b){var d="",e;return d+=' href="',e=c.url||a.url,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"url",{hash:{}})),d+=p(e)+'" ',d}c=c||a.helpers;var h="",i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression;i=c.avatar_image_url||b.avatar_image_url,j=c["if"],k=l.program(1,f,e),k.hash={},k.fn=k,k.inverse=l.noop,i=j.call(b,i,k);if(i||i===0)h+=i;return h+="\n",h}),a.registerPartial("avatar",c._avatar),c._avatar}),define("jst/discussions/_reply_form",["compiled/handlebars_helpers","i18n!discussions.reply_form"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/_reply_form"]=b(function(a,b,c,d,e){function f(a,b){var d="",e,f,g,h;d+="\n      ",e="Añadir un comentario...",f="add_side_comment",g={},h="discussions.reply_form",g.scope=h,h=c.t||a.t,n={},n.hash=g,typeof h===p?e=h.call(a,f,e,n):h===r?e=q.call(a,"t",f,e,n):e=h;if(e||e===0)d+=e;return d+="\n    ",d}function g(a,b){var d="",e,f,g,h;d+="\n      ",e="Escribe una respuesta...",f="write_a_reply",g={},h="discussions.reply_form",g.scope=h,h=c.t||a.t,n={},n.hash=g,typeof h===p?e=h.call(a,f,e,n):h===r?e=q.call(a,"t",f,e,n):e=h;if(e||e===0)d+=e;return d+="\n    ",d}function h(a,b){var d="",e,f,g,h;d+='\n          <a href="#" class="discussion-reply-add-attachment" data-event="addReplyAttachment">',e="Adjuntar",f="attach_file",g={},h="discussions.reply_form",g.scope=h,h=c.t||a.t,n={},n.hash=g,typeof h===p?e=h.call(a,f,e,n):h===r?e=q.call(a,"t",f,e,n):e=h;if(e||e===0)d+=e;return d+="</a>\n        ",d}c=c||a.helpers;var i="",j,k,l,m,n,o=this,p="function",q=c.helperMissing,r=void 0,s=this.escapeExpression;i+='<form class="discussion-section hide-if-collapsed discussion-reply-form">\n  <span class="notification" data-bind="notification"></span>\n  <label class="discussion-reply-label hide-if-replying" data-event="addReply" for="reply_message_for_',j=c.id||b.id,typeof j===p?j=j.call(b,{hash:{}}):j===r&&(j=q.call(b,"id",{hash:{}})),i+=s(j)+'">\n    ',j=c.allowsSideComments||b.allowsSideComments,k=c["if"],n=o.program(1,f,e),n.hash={},n.fn=n,n.inverse=o.program(3,g,e),j=k.call(b,j,n);if(j||j===0)i+=j;i+='\n  </label>\n  <div class="show-if-replying">\n    <textarea class="reply-textarea" id="reply_message_for_',j=c.id||b.id,typeof j===p?j=j.call(b,{hash:{}}):j===r&&(j=q.call(b,"id",{hash:{}})),i+=s(j)+'"></textarea>\n\n    <div class="clearfix">\n      <div class="discussion-reply-buttons">\n        <button class="button small-button" type="submit">',j="Publicar respuesta",k="post_response",l={},m="discussions.reply_form",l.scope=m,m=c.t||b.t,n={},n.hash=l,typeof m===p?j=m.call(b,k,j,n):m===r?j=q.call(b,"t",k,j,n):j=m;if(j||j===0)i+=j;i+='</button>\n        <a href="javascript:" class="cancel_button">',j="Cancelar",k="cancelar",l={},m="discussions.reply_form",l.scope=m,m=c.t||b.t,n={},n.hash=l,typeof m===p?j=m.call(b,k,j,n):m===r?j=q.call(b,"t",k,j,n):j=m;if(j||j===0)i+=j;i+='</a>\n      </div>\n\n      <div class="discussion-reply-attachments-container">\n        <ul class="discussion-reply-attachments"></ul>\n        ',j=c.canAttach||b.canAttach,k=c["if"],n=o.program(5,h,e),n.hash={},n.fn=n,n.inverse=o.noop,j=k.call(b,j,n);if(j||j===0)i+=j;return i+="\n      </div>\n    </div>\n  </div>\n</form>\n",i}),a.registerPartial("discussions/reply_form",c["discussions/_reply_form"]),c["discussions/_reply_form"]}),define("jst/discussions/_reply_attachment",["compiled/handlebars_helpers","i18n!discussions.reply_attachment"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/_reply_attachment"]=b(function(a,b,c,d,e){c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0;f+='<li>\n  <input name="attachment" type="file">\n  <a href="#" data-event="removeReplyAttachment">',g="Remover el archivo adjunto",h="remove_attachment",i={},j="discussions.reply_attachment",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+="</a>\n</li>\n",f}),a.registerPartial("discussions/reply_attachment",c["discussions/_reply_attachment"]),c["discussions/_reply_attachment"]}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/discussions/Reply",["compiled/backbone-ext/Backbone","use!underscore","i18n!discussions.reply","jquery","compiled/discussions/Entry","str/htmlEscape","jst/discussions/_reply_attachment","tinymce.editor_box"],function(b,c,d,e,f,g,h){var i;return i=function(){function b(b,c){this.view=b,this.options=c!=null?c:{},this.onPostReplyError=a(this.onPostReplyError,this),this.onPostReplySuccess=a(this.onPostReplySuccess,this),this.submit=a(this.submit,this),this.hide=a(this.hide,this),this.el=this.view.$(".discussion-reply-label:first"),this.showWhileEditing=this.el.next(),this.textarea=this.showWhileEditing.find(".reply-textarea"),this.form=this.el.closest("form").submit(a(function(a){return a.preventDefault(),this.submit()},this)),this.form.find(".cancel_button").click(this.hide),this.editing=!1}return b.prototype.toggle=function(){return this.editing?this.hide():this.edit()},b.prototype.edit=function(){return this.form.addClass("replying"),this.textarea.editorBox(),this.el.hide(),setTimeout(a(function(){return this.textarea.editorBox("focus")},this)),this.editing=!0,this.trigger("edit",this)},b.prototype.hide=function(){return this.content=this.textarea._justGetCode(),this.textarea._removeEditor(),this.form.removeClass("replying"),this.textarea.val(this.content),this.el.show(),this.editing=!1,!0},b.prototype.submit=function(){var a;return this.hide(),this.textarea._setContentCode(""),this.view.model.set("notification",d.t("saving_reply","Saving reply...")),a=new f(this.getModelAttributes()),a.save(null,{success:this.onPostReplySuccess,error:this.onPostReplyError,multipart:a.get("attachment")}),this.hide(),this.removeAttachments(),this.el.hide()},b.prototype.getModelAttributes=function(){var a;return a=(new Date).getTime(),{summary:e("<div/>").html(this.content).text(),message:this.content,parent_cid:this.options.topLevel?null:this.view.model.cid,parent_id:this.options.topLevel?null:this.view.model.get("id"),user_id:ENV.current_user_id,created_at:a,updated_at:a,collapsedView:!1,attachment:this.form.find("input[type=file]")[0]}},b.prototype.onPostReplySuccess=function(a){console.log("Entre al succes");var b,c;return(typeof (c=this.options).added=="function"?!c.added():!void 0)&&this.view.collection.add(a),this.view.model.get("allowsSideComments")?b="":b=d.t("reply_saved","Respuesta guardada, *ir a su respuesta*",{wrapper:"<a href='#"+a.cid+"' data-event='goToReply'>$1</a>"}),this.view.model.set("notification",b),this.el.show()},b.prototype.onPostReplyError=function(a){return console.log("entre al error"),this.view.model.set("notification",d.t("error_saving_reply","An error occured, please post your reply again later")),this.textarea.val(a.get("message")),this.edit()},b.prototype.addAttachment=function(a){return this.form.find("ul.discussion-reply-attachments").append(h()),this.form.find("a.discussion-reply-add-attachment").hide()},b.prototype.removeAttachment=function(a){return a.closest("ul.discussion-reply-attachments li").remove(),this.form.find("a.discussion-reply-add-attachment").show()},b.prototype.removeAttachments=function(){return this.form.find("ul.discussion-reply-attachments").empty()},b}(),c.extend(i.prototype,b.Events),i})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Object.prototype.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};define("compiled/discussions/EntryView",["require","i18n!discussions.entry","compiled/backbone-ext/Backbone","compiled/discussions/EntryCollection","jst/discussions/_entry_content","jst/discussions/_deleted_entry","jst/discussions/entry_with_replies","compiled/discussions/Reply","compiled/discussions/EntryEditor","compiled/discussions/MarkAsReadWatcher","str/htmlEscape","vendor/jquery.ba-tinypubsub","compiled/jquery.kylemenu","jst/_avatar","jst/discussions/_reply_form"],function(b,d,e,f,g,h,i,j,k,l,m,n){var o,p,q;return q=n.publish,p=function(){},o=function(){function b(){this.onReadState=a(this.onReadState,this),this.onCollapsedView=a(this.onCollapsedView,this),b.__super__.constructor.apply(this,arguments)}return c(b,e.View),b.instances=[],b.prototype.tagName="li",b.prototype.className="entry",b.prototype.initialize=function(){var c;return b.__super__.initialize.apply(this,arguments),c=this.model.get("id"),b.instances[c]=this,this.model.bind("change:id",a(function(a,b){return this.$el.attr("data-id",b)},this)),this.model.bind("change:collapsedView",this.onCollapsedView),this.model.bind("change:read_state",this.onReadState),this.render(),this.model.bind("change:deleted",a(function(a,b){return this.$(".discussion_entry:first").toggleClass("deleted-discussion-entry",b)},this)),this.model.get("deleted")&&this.$(".discussion_entry:first").addClass("deleted-discussion-entry"),this.toggleCollapsedClass(),this.createReplies()},b.prototype.onCollapsedView=function(a,b){var c;this.toggleCollapsedClass();if(this.model.get("hideRepliesOnCollapse"))return c=this.$(".replies, .add-side-comment-wrap"),b?c.hide():c.show()},b.prototype.onReadState=function(a,b){var c;return b==="unread"&&(c=this.markAsReadWatcher)==null&&(this.markAsReadWatcher=new l(this)),this.$("article:first").toggleClass("unread",b==="unread")},b.prototype.fetchFullEntry=function(){return this.model.set("message",d.t("loading","loading...")),this.model.fetch()},b.prototype.toggleCollapsedClass=function(){var a;return a=this.model.get("collapsedView"),this.$el.children(".discussion_entry").toggleClass("collapsed",!!a).toggleClass("expanded",!a)},b.prototype.render=function(){return this.$el.html(i(this.model.toJSON())),this.$el.attr("data-id",this.model.get("id")),this.$el.attr("id",this.model.cid),q("userContent/change"),b.__super__.render.apply(this,arguments)},b.prototype.openMenu=function(a,b){return this.$menu||this.createMenu(b),this.$menu.popup("open"),!1},b.prototype.createMenu=function(b){return b.kyleMenu({appendMenuTo:"body",buttonOpts:{icons:{primary:null,secondary:null}}}),this.$menu=b.data("kyleMenu"),this.$menu.delegate("[data-event]","click",a(function(a){var c;return a.preventDefault(),b=$(a.currentTarget),c=b.data("event"),this[c](a,b)},this))},b.prototype.createReplies=function(){},b.prototype.remove=function(){var a;return this.model.set("collapsedView",!0),a=h(this.model.toJSON()),this.$(".entry_content:first").html(a),this.model.destroy()},b.prototype.edit=function(){var a;return(a=this.editor)==null&&(this.editor=new k(this)),this.editor.edit(),!1},b.prototype.toggleCollapsed=function(a,b){return this.model.set("collapsedView",!this.model.get("collapsedView"))},b.prototype.addReply=function(a,b){var c;return a.preventDefault(),(c=this.reply)==null&&(this.reply=new j(this)),this.model.set("notification",""),this.reply.edit()},b.prototype.addReplyAttachment=function(a,b){return a.preventDefault(),this.reply.addAttachment(b)},b.prototype.removeReplyAttachment=function(a,b){return a.preventDefault(),this.reply.removeAttachment(b)},b.prototype.goToReply=function(a,b){},b}(),b(["compiled/discussions/EntryCollectionView"],function(b){return o.prototype.createReplies=function(){var c,d;return c=this.$el.find(".replies"),this.collection=new f,this.view=new b({$el:c,collection:this.collection}),d=this.model.get("replies"),_.each(d,a(function(a){return a.parent_cid=this.model.cid},this)),this.collection.reset(this.model.get("replies"))}}),o})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Object.prototype.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};define("compiled/discussions/EntryCollectionView",["compiled/backbone-ext/Backbone","compiled/discussions/EntryView","jst/discussions/EntryCollectionView"],function(b,d,e){var f;return f=function(){function f(){this.addAll=a(this.addAll,this),this.add=a(this.add,this),f.__super__.constructor.apply(this,arguments)}return c(f,b.View),f.prototype.initialize=function(a){return this.$el=a.$el,this.collection=a.collection,this.collection.bind("reset",this.addAll),this.collection.bind("add",this.add),this.render()},f.prototype.render=function(){var a;return a=e(this.options),this.$el.html(a),this.cacheElements()},f.prototype.cacheElements=function(){return this.list=this.$el.children(".discussion-entries")},f.prototype.add=function(a){var b;return b=new d({model:a}),this.list.append(b.el)},f.prototype.addAll=function(){return this.collection.each(this.add)},f}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Object.prototype.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};define("compiled/discussions/EntriesView",["use!underscore","jquery","compiled/backbone-ext/Backbone","compiled/discussions/EntryCollection","compiled/discussions/EntryCollectionView","compiled/discussions/EntryView","compiled/discussions/ParticipantCollection","compiled/discussions/MarkAsReadWatcher","jst/discussions/_reply_form","vendor/ui.selectmenu"],function(b,d,e,f,g,h,i,j,k,l){var m;return m=function(){function k(){this.onFetchSuccess=a(this.onFetchSuccess,this),this.onMarkAsRead=a(this.onMarkAsRead,this),this.initParticipants=a(this.initParticipants,this),this.initEntries=a(this.initEntries,this),k.__super__.constructor.apply(this,arguments)}return c(k,e.View),k.prototype.events={"click .entry [data-event]":"handleEntryEvent"},k.prototype.initialize=function(){return this.$el=d("#discussion_subentries"),this.participants=new i,this.model.bind("change:participants",this.initParticipants),this.collection=new f,this.model.bind("change:view",this.initEntries),j.on("markAsRead",this.onMarkAsRead),this.model.fetch({success:this.onFetchSuccess})},k.prototype.initEntries=function(a,b){return this.collectionView=new g({$el:this.$el,collection:this.collection,showReplyButton:!0}),this.collection.reset(b),this.updateFromNewEntries(),this.setUnreadEntries(),j.init()},k.prototype.updateFromNewEntries=function(){var c;return c=this.model.get("new_entries"),b.each(c,a(function(a){var b;return b=h.instances[a.id],b?b.model.set(a):(b=h.instances[a.parent_id]||this,b.collection.add(a))},this))},k.prototype.setUnreadEntries=function(){var a;return a=this.model.get("unread_entries"),b.each(a,function(a){return h.instances[a].model.set("read_state","unread")})},k.prototype.initParticipants=function(a,b){return this.participants.reset(b)},k.prototype.onMarkAsRead=function(a){var c,d;return d=this.model.get("unread_entries"),c=a.get("id"),this.model.set("unread_entries",b.without(d,c))},k.prototype.onFetchSuccess=function(){return this.model.trigger("fetchSuccess",this.model)},k.prototype.handleEntryEvent=function(a){var b,c,e,f,g;return b=d(a.currentTarget),f=b.data("event"),g=b.parents("."+h.prototype.className+":first"),c=g.data("id"),e=h.instances[c],e[f].call(e,a,b)},k}()})}.call(this),function(){define("compiled/util/wikiSidebarWithMultipleEditors",["wikiSidebar","tinymce.editor_box","compiled/tinymce"],function(a){return $.subscribe("editorBox/focus",function(b){return a.inited||a.init(),a.show(),a.attachToEditor(b)}),$.subscribe("editorBox/removeAll",function(){return a.hide()})})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Object.prototype.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};define("compiled/discussions/TopicView",["i18n!discussions","compiled/backbone-ext/Backbone","compiled/discussions/Topic","compiled/discussions/EntriesView","compiled/discussions/EntryView","jst/discussions/_reply_form","compiled/discussions/Reply","compiled/widget/assignmentRubricDialog","compiled/util/wikiSidebarWithMultipleEditors","jquery.instructure_misc_helpers"],function(b,d,e,f,g,h,i,j){var k;return k=function(){function k(){this.onUnreadChange=a(this.onUnreadChange,this),this.initEntries=a(this.initEntries,this),k.__super__.constructor.apply(this,arguments)}return c(k,d.View),k.prototype.events={"click #discussion_topic .discussion-reply-form [data-event]":"handleEvent","change .view_switcher":"switchView","click .add_root_reply":"addRootReply"},k.prototype.initialize=function(){return this.$el=$("#main"),this.model.set("id",ENV.DISCUSSION.TOPIC.ID),this.model.cid="main",this.model.set("canAttach",ENV.DISCUSSION.PERMISSIONS.CAN_ATTACH),this.render(),ENV.DISCUSSION.INITIAL_POST_REQUIRED||this.initEntries(),this.initViewSwitcher(),$(document.body).is(".with-right-side")&&$.scrollSidebar(),j.initTriggers(),this.disableNextUnread(),this.$el.toggleClass("side_comment_discussion",!ENV.DISCUSSION.THREADED)},k.prototype.cacheElements=function(){return this.$addRootReply=this.$(".add_root_reply")},k.prototype.initEntries=function(){return this.discussion?!1:(this.discussion=new f({model:new e}),this.collection=this.discussion.collection,this.discussion.model.bind("change:unread_entries",this.onUnreadChange),this.discussion.model.bind("fetchSuccess",a(function(){var a;return a=this.discussion.model.get("unread_entries"),this.setNextUnread(a),this.cacheElements()},this)),window.DISCUSSION=this.discussion,!0)},k.prototype.onUnreadChange=function(a,c){return this.model.set("unreadCount",c.length),this.model.set("unreadText",b.t("unread_count_tooltip",{zero:"No unread replies",one:"1 unread reply",other:"%{count} unread replies"},{count:c.length})),this.setNextUnread(c)},k.prototype.setNextUnread=function(a){var b,c,d;if(a.length===0){this.disableNextUnread();return}return d=this.discussion.$(".can_be_marked_as_read.unread:first"),c=d.parent(),b=c.attr("id"),this.$("#jump_to_next_unread").removeClass("disabled").attr("href","#"+b)},k.prototype.disableNextUnread=function(){return this.$("#jump_to_next_unread").addClass("disabled").removeAttr("href")},k.prototype.addReply=function(b){return b.preventDefault(),this.reply==null&&(this.reply=new i(this,{topLevel:!0,added:this.initEntries}),this.reply.on("edit",a(function(){return this.$addRootReply.hide()},this)),this.reply.on("hide",a(function(){return this.$addRootReply.show()},this))),this.model.set("notification",""),this.reply.edit()},k.prototype.addReplyAttachment=g.prototype.addReplyAttachment,k.prototype.removeReplyAttachment=g.prototype.removeReplyAttachment,k.prototype.handleEvent=function(a){var b,c;return b=$(a.currentTarget),c=b.data("event"),typeof this[c]=="function"?this[c](a,b):void 0},k.prototype.render=function(){var a;return ENV.DISCUSSION.PERMISSIONS.CAN_REPLY&&(a=h(this.model.toJSON()),this.$(".entry_content:first").append(a)),k.__super__.render.apply(this,arguments)},k.prototype.initViewSwitcher=function(){return this.$(".view_switcher").show().selectmenu({icons:[{find:".collapsed-view"},{find:".unread-view"},{find:".expanded-view"}]})},k.prototype.switchView=function(a){var b,c;return b=$(a.currentTarget),c=b.val(),this[c+"View"]()},k.prototype.collapsedView=function(){var a,b,c,d;c=g.instances,d=[];for(a in c)b=c[a],d.push(b.model.set("collapsedView",!0));return d},k.prototype.expandedView=function(){var a,b,c,d;c=g.instances,d=[];for(a in c)b=c[a],d.push(b.model.set("collapsedView",!1));return d},k.prototype.unreadView=function(){var a,b,c,d,e;d=g.instances,e=[];for(b in d)c=d[b],a=c.model.get("read_state")==="read",e.push(c.model.set("collapsedView",a));return e},k.prototype.addRootReply=function(a){var b,c;return b=this.$(a.currentTarget),c=$("#discussion_topic .discussion-reply-form"),this.addReply(a),$("html, body").animate({scrollTop:c.offset().top-100})},k}()})}.call(this),function(){require(["compiled/backbone-ext/Backbone","compiled/discussions/TopicView"],function(a,b){return $(function(){var c;return c=new b({model:new a.Model})})})}.call(this),define("compiled/bundles/discussion",function(){})